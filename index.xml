<?xml-stylesheet href="/rss.xsl" type="text/xsl"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Pavel Danov</title>
    <link>https://underscorehao.net/</link>
    <description>Recent content on Pavel Danov</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>Copyright 2017-2023 by Pavel Danov</copyright>
    <lastBuildDate>Wed, 10 Nov 2021 12:50:00 +0000</lastBuildDate>
    
        <atom:link href="https://underscorehao.net/index.xml" rel="self" type="application/rss+xml" />
    
    
    
        <item>
        <title>Compiling C&#43;&#43; project using SFML with cl.exe</title>
        <link>https://underscorehao.net/2021/11/compiling-cpp-sfml-windows-cli/</link>
        <pubDate>Wed, 10 Nov 2021 12:50:00 +0000</pubDate>
        
        <guid>https://underscorehao.net/2021/11/compiling-cpp-sfml-windows-cli/</guid>
        <description>Pavel Danov https://underscorehao.net/2021/11/compiling-cpp-sfml-windows-cli/ -&lt;h2 id=&#34;why&#34;&gt;Why?&lt;/h2&gt;
&lt;p&gt;The usefulness of this approach is debatable, but let me try to offer an answer on why you might want to know how to do that. I think it&amp;rsquo;s the mark of a good engineer to know what&amp;rsquo;s happening under the hood. Simple as that. New or inexperienced developers will benefit from understanding the connection between the user interface in Visual Studio and the actual command line tools used underneath.&lt;/p&gt;
&lt;h2 id=&#34;prerequisites&#34;&gt;Prerequisites&lt;/h2&gt;
&lt;p&gt;Imagine that you&amp;rsquo;re on Windows and want to use the &lt;a href=&#34;https://docs.microsoft.com/en-us/cpp/build/building-on-the-command-line?view=msvc-170&#34;&gt;MSVC&lt;/a&gt; compiler toolset from the command line to build a project with &lt;a href=&#34;https://www.sfml-dev.org/index.php&#34;&gt;SFML&lt;/a&gt;. In a nutshell you&amp;rsquo;re going to replicate the documentation given for &lt;a href=&#34;https://www.sfml-dev.org/tutorials/2.5/start-vc.php&#34;&gt;SFML and Visual Studio&lt;/a&gt;, but from the terminal.&lt;/p&gt;
&lt;p&gt;Assuming you have installed all the necessarry tooling and you have SFML in the &lt;code&gt;C:\libs\SFML-2.5.1&lt;/code&gt; directory you can just do the following.&lt;/p&gt;
&lt;h2 id=&#34;dynamic-linking&#34;&gt;Dynamic Linking&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;# For DEBUG builds -d is part of the lib names. See SFML docs on that.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;cl Main.cpp Game.cpp Window.cpp &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;sfml-graphics-d.lib&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;sfml-window-d.lib&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;sfml-system-d.lib&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;sfml-audio-d.lib&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;sfml-network-d.lib&amp;#34;&lt;/span&gt; /I &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;C:\libs\SFML-2.5.1\include&amp;#34;&lt;/span&gt; /MDd /link /LIBPATH:&lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;C:\libs\SFML-2.5.1\lib&amp;#34;&lt;/span&gt; /DEBUG
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Let&amp;rsquo;s quickly break that down.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;After &lt;code&gt;cl&lt;/code&gt; put your &lt;code&gt;.cpp&lt;/code&gt; files, then add all &lt;code&gt;.lib&lt;/code&gt; files because the linker will look for those.&lt;/li&gt;
&lt;li&gt;With &lt;a href=&#34;https://docs.microsoft.com/en-us/cpp/build/reference/i-additional-include-directories?view=msvc-170&#34;&gt;/I&lt;/a&gt; you include the path to the SFML headers.&lt;/li&gt;
&lt;li&gt;Next is &lt;a href=&#34;https://docs.microsoft.com/en-us/cpp/build/reference/md-mt-ld-use-run-time-library?view=msvc-170&#34;&gt;/MDd&lt;/a&gt; which is dealing with the runtime and adding additional debug information.&lt;/li&gt;
&lt;li&gt;We also need &lt;a href=&#34;https://docs.microsoft.com/en-us/cpp/build/reference/link-pass-options-to-linker?view=msvc-170&#34;&gt;/link&lt;/a&gt; which is used to pass options to the linker and in this case we&amp;rsquo;re passing &lt;a href=&#34;https://docs.microsoft.com/en-us/cpp/build/reference/libpath-additional-libpath?view=msvc-170&#34;&gt;/LIBPATH&lt;/a&gt; which contains the path to the SFML libraries.&lt;/li&gt;
&lt;li&gt;Finally we pass &lt;a href=&#34;https://docs.microsoft.com/en-us/cpp/build/reference/debug-generate-debug-info?view=msvc-170&#34;&gt;/DEBUG&lt;/a&gt; to the linker because we&amp;rsquo;re doing a debug build in this case.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This will create a &lt;code&gt;Main.exe&lt;/code&gt; in your current folder. You&amp;rsquo;ll need to add the appropriate SFML &lt;code&gt;.dll&lt;/code&gt; files to that folder in order to execute your program successfully.&lt;/p&gt;
&lt;h2 id=&#34;static-linking&#34;&gt;Static Linking&lt;/h2&gt;
&lt;p&gt;For static linking the process is almost the same with some slight differences.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;# Note -s-d as part of the lib names. See SFML docs on that.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;cl Main.cpp Game.cpp Window.cpp &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;sfml-graphics-s-d.lib&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;sfml-window-s-d.lib&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;sfml-system-s-d.lib&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;sfml-audio-s-d.lib&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;sfml-network-s-d.lib&amp;#34;&lt;/span&gt; opengl32.lib freetype.lib winmm.lib gdi32.lib user32.lib Advapi32.lib /I &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;C:\libs\SFML-2.5.1\include&amp;#34;&lt;/span&gt; /D SFML_STATIC /MDd /link /LIBPATH:&lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;C:\libs\SFML-2.5.1\lib&amp;#34;&lt;/span&gt; /DEBUG
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;This time we&amp;rsquo;re including the static version of the SFML libraries.&lt;/li&gt;
&lt;li&gt;We have to pass the extra dependencies needed by SFML in order for the build to be successful and not blow up with a lot of link errors.&lt;/li&gt;
&lt;li&gt;We use the &lt;a href=&#34;https://docs.microsoft.com/en-us/cpp/build/reference/d-preprocessor-definitions?view=msvc-170&#34;&gt;/D&lt;/a&gt; flag to define the &lt;code&gt;SFML_STATIC&lt;/code&gt; macro.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;If all is well you&amp;rsquo;ll be able to just run your &lt;code&gt;Main.exe&lt;/code&gt; straight away.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://underscorehao.net/images/sfml-compile.gif&#34;
         alt=&#34;Compiling a project with SFML in Vim&#34;/&gt;&lt;figcaption&gt;
            &lt;p&gt;Compiling a project with SFML in Vim&lt;/p&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;h2 id=&#34;final-words&#34;&gt;Final Words&lt;/h2&gt;
&lt;p&gt;Learn to use CMake :)&lt;/p&gt;
- https://underscorehao.net/2021/11/compiling-cpp-sfml-windows-cli/ - Copyright 2017-2023 by Pavel Danov</description>
        </item>
    
    
    
        <item>
        <title>How I learned 1500 Chinese Characters in a Month - Heisig Method Review</title>
        <link>https://underscorehao.net/2020/05/learning-1500-chinese-characters-in-a-month-heisig-method-review/</link>
        <pubDate>Thu, 14 May 2020 20:00:00 +0100</pubDate>
        
        <guid>https://underscorehao.net/2020/05/learning-1500-chinese-characters-in-a-month-heisig-method-review/</guid>
        <description>Pavel Danov https://underscorehao.net/2020/05/learning-1500-chinese-characters-in-a-month-heisig-method-review/ -&lt;h2 id=&#34;introduction&#34;&gt;Introduction&lt;/h2&gt;
&lt;p&gt;Hello dear visitor!&lt;/p&gt;
&lt;p&gt;Before you stands a very long article in which you&amp;rsquo;ll find my review and results after spending 31 days with a book called &lt;a href=&#34;https://www.goodreads.com/book/show/5862954-remembering-simplified-hanzi-1&#34;&gt;Remembering Simplified Hanzi 1: How Not to Forget the Meaning and Writing of Chinese Characters&lt;/a&gt; written by James Heisig and Timothy W. Richardson. I think it&amp;rsquo;s a groundbreaking book and an amazing method because it broke down a certain wall that was hindering my desire and drive to learn the Chinese language for a long time.&lt;/p&gt;
&lt;p&gt;I&amp;rsquo;m no stranger to language learning having studied English, German and Russian in the past, but Chinese language was always an enigma for me, as I&amp;rsquo;m sure it is for most of the world!&lt;/p&gt;
&lt;p&gt;In this text I&amp;rsquo;ve outlined my personal journey in trying to learn Chinese, as well as my experience with other languages.&lt;/p&gt;
&lt;p&gt;I understand that you might not care about this information, but I think it&amp;rsquo;s crucial so you can understand where I&amp;rsquo;m coming from and why the method introduced in the aforementioned book worked so well for me.&lt;/p&gt;
&lt;p&gt;The book is based on the experience and method of James Heisig, who while visiting Japan for the first time years ago created the method and learned 1900 Kanji in a month with a full day of studying. My own data confirms his claim that the method (now refined after years) does work! I have learned 1500 Chinese characters in 31 days with less than 2 hours of studying every day while working full time as a Software Engineer.&lt;/p&gt;
&lt;p&gt;I can&amp;rsquo;t guarantee it&amp;rsquo;s going to work for you, but I can explain and show you why it worked for me! If you care only about the results, feel free to use the links at the top of the page in the &lt;code&gt;Table of Contents&lt;/code&gt;, but I implore you to reconsider and read the whole article :)&lt;/p&gt;
&lt;p&gt;If you&amp;rsquo;re not familiar with the method I strongly suggest before you start reading my review that you read the &lt;code&gt;Introduction&lt;/code&gt; chapter of the book. A link to a sample and the first 6 chapters is freely available at the website of the university where James Heisig conducts research - you can find it in the references at the end &lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;p&gt;With that being said, let&amp;rsquo;s begin!&lt;/p&gt;
&lt;h2 id=&#34;first-encounters-with-中文&#34;&gt;First encounters with 中文&lt;/h2&gt;
&lt;p&gt;I&amp;rsquo;ve been enamored with Chinese culture since I was a child. My very first memory of seeing Chinese characters is imprinted in my brain as if it was yesterday.&lt;/p&gt;
&lt;p&gt;The story begins sometime in the mid 90&amp;rsquo;s when I was in kindergarten. My dad had an enormous book collection at the time and I raided it constantly in search for interesting things. I don&amp;rsquo;t remember if I could read at that point, but my hunt bore fruit every time I found a picture or illustration that could spin my imagination.&lt;/p&gt;
&lt;p&gt;One day I was sifting through the mountains of books as I usually had done in the past and I encountered a book called &lt;code&gt;Мифологический словарь&lt;/code&gt; (Mythological dictionary) &lt;sup id=&#34;fnref1:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;. Bulgaria being a country of the former Warsaw Pact (and not an ex-Soviet republic as some people wrongly assume when I tell them where I&amp;rsquo;m from) had very close ties with the USSR. That meant that most Bulgarians interested in scientific topics had Russian books on these subjects. My father wasn&amp;rsquo;t an exception in this case. It&amp;rsquo;s not uncommon even to this day to find a lot of books in Russian in a majority of Bulgarian homes.&lt;/p&gt;
&lt;p&gt;But I digress&amp;hellip;&lt;/p&gt;
&lt;p&gt;As I was going through this book I looked at the paintings and illustrations that were in it. There were two pictures of what I now know are &lt;a href=&#34;https://en.wikipedia.org/wiki/Jiang_Ziya&#34;&gt;Jiang Ziya&lt;/a&gt; on a unicorn and &lt;a href=&#34;https://en.wikipedia.org/wiki/Zhang_Daoling&#34;&gt;Zhang Daoling&lt;/a&gt; on a tiger. Both of them looked like some powerful sorcerers to me. I hope you&amp;rsquo;ll agree that they look rather impressive! However, the most interesting thing to my young eyes in those paintings were the symbols on either side of them! I was immediately drawn to the Chinese characters. They looked magical and mysterious  like nothing I&amp;rsquo;ve ever seen before. I don&amp;rsquo;t remember much after that, but I recall that I was trying to replicate these symbols on a piece of paper.&lt;/p&gt;
&lt;p&gt;It&amp;rsquo;s been sort of a family joke since then that my fascination with the East has started with these two paintings at that exact moment. There&amp;rsquo;s definitely some truth in that!&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://underscorehao.net/images/chinese-sages-jiang-ziya-and-zhang-daoling.jpg&#34;
         alt=&#34;The wise Chinese sages - Jiang Ziya (left) and Zhang Daoling (right); Мифологический словарь p. 657&#34;/&gt;&lt;figcaption&gt;
            &lt;p&gt;The wise Chinese sages - Jiang Ziya (left) and Zhang Daoling (right); Мифологический словарь p. 657&lt;/p&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;h2 id=&#34;great-wall-of-characters&#34;&gt;Great Wall of Characters&lt;/h2&gt;
&lt;p&gt;A couple of years passed by and me now in the first or second grade saw me experience my first action movie starring Jackie Chan. The movie in question was &lt;code&gt;Rumble in the Bronx&lt;/code&gt;. It was he who introduced me to martial arts and opened an entirely different world to me. That crazy jump between two buildings will be forever seared in my brain as one of the coolest things someone had ever done. If you haven&amp;rsquo;t watched it I strongly recommend it - it&amp;rsquo;s a classic!&lt;/p&gt;
&lt;p&gt;Soon after I found about Bruce Lee, Jet Li, Donnie Yen. &lt;code&gt;Crouching Tiger, Hidden Dragon&lt;/code&gt; came out and the flying once more blew my mind!&lt;/p&gt;
&lt;p&gt;After nagging my mom for a long time, I finally attended my first karate lessons when I turned 10 years old.&lt;/p&gt;
&lt;p&gt;The mysterious East was always a part of me from that point onwards. I&amp;rsquo;ve watched so much Asian (mainly Chinese and Japanese) cinema, watched anime, read books on history, culture and trained various eastern martial arts.&lt;/p&gt;
&lt;p&gt;I&amp;rsquo;ve had Chinese and Japanese phases of my fascination, but I never forgot that China was the source. That&amp;rsquo;s where those magical Chinese characters originated from.&lt;/p&gt;
&lt;p&gt;Compelling as they were to me though, I couldn&amp;rsquo;t make myself actually learn them. It seemed impossible to even try. My teenage self was thinking that Chinese and Japanese people can learn them all after years and years of diligent rote memorization - nothing else would work. There&amp;rsquo;s just an enormous amount of characters. And then you have to think about the pronunciation and grammar, and it seems like an impossible task the more and more you delve in it. Confronting the writing system was akin to standing in front of an impenetrable wall - a &lt;code&gt;Great Wall of Characters&lt;/code&gt; if you will! It seemed insurmountable to climb through it.&lt;/p&gt;
&lt;p&gt;James Heisig and Timothy W. Richardson the authors of &lt;code&gt;Remembering Simplified Hanzi&lt;/code&gt; have this to say about my exact experience in the introduction of the book.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;To students approaching Chinese from a mother tongue written with an alphabet, the characters represent a forbidding obstacle, one that involves the memorization of thousands of complex configurations, each of which has to be tethered to a particular sound and a particular meaning or function. Focusing for the moment just on what is involved in trying to commit the written forms to memory, imagine yourself holding a kaleidoscope up to the light as still as possible, trying to fix in memory the particular pattern that the play of light and mirrors and colored stones has created. Chances are, your mind is unaccustomed to processing such material and it will take some time to organize the pattern for retention and recall. But let us suppose that you succeed after ten or fifteen minutes. You close your eyes, trace the pattern in your head, and then check your image against the original pattern, repeating the process until you are sure you have it committed to memory.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;Then someone passes by and jars your elbow. The pattern is lost forever and in its place a new jumble appears. Immediately your memory begins to scramble. You set the kaleidoscope aside, sit down, and try to draw what you had just memorized, but to no avail. There is simply nothing left in memory to grab hold of. The characters are like that. One can sit at one’s desk and drill a number of characters for an hour or two, only to discover on the morrow that when something similar is seen, the former memory is erased or hopelessly confused by the new information. No wonder learners begin to think that they simply don’t have a good memory for characters, or decide that learning to write characters is not so important anyway &lt;sup id=&#34;fnref:2&#34;&gt;&lt;a href=&#34;#fn:2&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;2&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I&amp;rsquo;ve started and given up trying to learn either Chinese or Japanese (based on the phase I was in) more times than I&amp;rsquo;d like to admit. This continued for years, until one day not very long ago I found that book and something finally clicked in my head. The path that I had to take revealed itself to me.&lt;/p&gt;
&lt;p&gt;To understand this change of mindset however, I&amp;rsquo;ll have to share context on some of the other languages that I&amp;rsquo;ve learned during the years and how I approached them at the time. Presenting that information is important, because the conclusions from my small experiment with the Heisig method are based on that past experience just as much as with following the actual method.&lt;/p&gt;
&lt;p&gt;As I am going through my own past language learning experience I&amp;rsquo;m going to list some of the biases around learning Chinese characters given in the &lt;code&gt;Introduction&lt;/code&gt; by the authors of &lt;a href=&#34;https://www.goodreads.com/book/show/5862954-remembering-simplified-hanzi-1&#34;&gt;Remembering Simplified Hanzi&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&#34;learning-indo-european-languages&#34;&gt;Learning (Indo-European) Languages&lt;/h2&gt;
&lt;p&gt;My native &lt;a href=&#34;https://en.wikipedia.org/wiki/Bulgarian_language&#34;&gt;Bulgarian&lt;/a&gt; language is an Indo-European language. Every other language I&amp;rsquo;ve tried to learn beside Chinese (Sino-Tibetan) and Japanese (Japonic) has been part of the same language family as my native Bulgarian.&lt;/p&gt;
&lt;p&gt;In Bulgaria foreign language schools were (and still are) very popular so my parents enrolled me in a German language school when I started 1st grade. There I learned German for 7 years until the 7th grade. Since it was mandatory to choose a second language in the 5th grade I chose Russian and I studied it for 3 years.&lt;/p&gt;
&lt;p&gt;English is the odd case in my language learning journey. English I haven&amp;rsquo;t studied anywhere officially (or seriously for that matter) aside from a small stint in a private academy before I was in the first grade and for a brief time in my new school when I switched schools in the 8th grade. To be honest I don&amp;rsquo;t remember any of it. By the time I was in the 8th grade English felt very natural to me.&lt;/p&gt;
&lt;p&gt;The story of how I learned English weirds even myself sometimes, but that&amp;rsquo;s the way things are. I learned English via the following methods and completely &lt;code&gt;passively&lt;/code&gt; at that:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Being the curious child I was, I watched Discovery Channel all the time (at the time it was in English and subtitled in Bulgarian, nowadays everything is dubbed in Bulgarian). Doing this for years did wonders to my vocabulary. Hearing the same words over and over again made me subconsciously attach the translations from the subtitles to the words I&amp;rsquo;ve been hearing.&lt;/li&gt;
&lt;li&gt;Another big reason in the same vein was Cartoon Network, perhaps even before discovering Discovery Channel (sorry, a bad pun, I know). Dexter&amp;rsquo;s Laboratory, Samurai Jack, PPG, Ed, Edd &amp;amp; Eddy, Courage the Cowardly Dog and countless more shows. I knew most of their episodes by heart (still remember a lot of them). All of these programs were in English without subtitles. Essentially my TV watching habits when I was a child were Discovery Channel + Cartoon Network. One helped for attaining vocabulary and the other was pure comprehension. It was an approach that worked remarkably well.&lt;/li&gt;
&lt;li&gt;And last but not least. Internet and videogames. Playing games where you don&amp;rsquo;t understand anything was pretty fun still because, well, you&amp;rsquo;re playing a game! At some point after years and years of clicking stuff and watching/hearing what happens next I started to understand. Texts, dialogues. You can read without understanding half of the words, but just the act of reading unlocks your brain into absorbing the language.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;So to summarize shortly - immersing yourself in a language will make you learn it! This is not contrary to popular advice at all. This is how small children learn their native tongue. I didn&amp;rsquo;t follow a rigorous studying pattern or anything like that. I was just a child watching interesting things on TV and playing computer games.&lt;/p&gt;
&lt;p&gt;The interesting bit of my own experience and the reason I&amp;rsquo;m explaining all of this is the concrete combination of steps and how they flowed between each other subconsciously.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Listening a foreign language and reading a translation of what&amp;rsquo;s being said in real-time. This adds to your vocabulary.&lt;/li&gt;
&lt;li&gt;Listening to a foreign language by itself. This combined with step 1 aids your comprehension ability.&lt;/li&gt;
&lt;li&gt;Reading the language combines both steps 1 and 2.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;I&amp;rsquo;ve learned English on a higher level by myself than I ever did by learning German and Russian structurally in school by following the 3 steps above for years without even knowing it. This is perfectly captured by the authors when they write about how Chinese children already know the language by the time they start practicing characters.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;As children, they are exposed first to the spoken language, learning how to associate sounds with meanings. When the time comes to learn how to read, they already have at their disposal a solid basis of words whose sounds and meanings are familiar to them; all that remains is to associate those words with written forms. Doing so opens them to printed texts, which, in turn, helps them assimilate new words and characters. &lt;sup id=&#34;fnref1:2&#34;&gt;&lt;a href=&#34;#fn:2&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;2&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;At school we were following the official study plan and it was basically cramming of grammar, vocabulary, listening and reading all at the same time. I have to tell you that it was painful. It was a very cumbersome system and a lot of language academies and systems follow the same approach to this day. It&amp;rsquo;s a commonly accepted way of learning a language and I&amp;rsquo;m sure it has helped me in some capacity in my journey of learning both languages (to a degree), but I&amp;rsquo;ve never been able to quantify it. It always seemed like a chore. Compare that with my natural way of learning English and there is a striking difference. Me learning English was not something I intended, it&amp;rsquo;s just something that happened.&lt;/p&gt;
&lt;p&gt;Now that I&amp;rsquo;m an adult I won&amp;rsquo;t be able to replicate that effect once more with a different language. I&amp;rsquo;m too aware now and I want quantifiable results and specific methods and patterns to follow.&lt;/p&gt;
&lt;p&gt;One of the traps I&amp;rsquo;ve fallen into when starting to learn Chinese before was once again described in the &lt;code&gt;Introduction&lt;/code&gt; of the book:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;One bias circulating among teachers and students of the Chinese language is that a character’s meaning, pronunciation, and writing need to be learned at the same time. Chinese textbooks typically include all three bits of information for each character or compound term as it is introduced, in addition to supplying details about grammatical function and examples of usage. Of course, these things are important, but to have to learn them all at once places an unreasonable burden on memory. Little wonder that the brain slows down or grinds to a complete halt. &lt;sup id=&#34;fnref2:2&#34;&gt;&lt;a href=&#34;#fn:2&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;2&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;My own experience confirms this is true not only for learning Chinese but for learning German and Russian in school as well. Studying all these elements at the same time is just too much.&lt;/p&gt;
&lt;p&gt;Then the authors go even further and make the most important point (at least to me) in the entire book.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Yet another bias that needs uprooting is the idea that characters can only be mastered through constant drill and repetition. Traditional methods for approaching the Chinese writing system have been the same as those for learning alphabets: practice writing the characters one by one, over and over again, for as long as it takes. Whatever ascetic value there is in such an exercise, it is hardly the most efficient way to approach character study. The reason this bias has such a strong hold on students of Chinese is that persons completely ignorant of the Chinese writing system naturally rely on teachers who have learned characters from childhood. Surely a pedagogy with many centuries of history behind it and over a billion users demands our respect.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;Here again, the prevailing wisdom is deceptive. Native speakers of Chinese are clearly in a position to teach a good many things about their language, but they are not necessarily qualified to answer questions from non-native speakers about how best to learn the characters, for the simple reason that they themselves have never been in the situation of having to ask such a question. Having begun their study as children, in whom the powers of abstraction were not yet developed and for whom rote memory was the only option, they cannot be expected to fully grasp the learning potential an adult brings to the study of the characters. As children, we were all good &lt;strong&gt;imitators&lt;/strong&gt;, with few habits to get in the way of our absorption of new skills. But we did not become good learners until we had the ability to classify, categorize, and organize discrete bits of information into larger blocks. This is precisely what young children cannot do with character forms and why they have no choice but to rely on imitation and repetition. Whatever educational and social advantages there may be to having an entire school population study Chinese characters by writing them again and again from an early age, for the adult approaching the language from the outside it amounts to little more than a gigantic waste of time. &lt;sup id=&#34;fnref3:2&#34;&gt;&lt;a href=&#34;#fn:2&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;2&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;when-in-rome-do-as-the-romans-do&#34;&gt;When in Rome (do as the Romans do)&lt;/h3&gt;
&lt;p&gt;At this stage in the article it&amp;rsquo;s time for me to say that I learn best while reading. It&amp;rsquo;s my preferred method of knowledge transfer and I memorize the most information while doing it. If I&amp;rsquo;m learning a new language, reading is the most crucial bit and my own anecdotal experience with English confirms it. I could read English long before I understood even a portion of what I was reading. Same goes for German and Russian to a lesser extent. Reading without understanding has helped me enormously nonetheless.&lt;/p&gt;
&lt;p&gt;However, when it comes to learning a language without an alphabet like Chinese, things become a &amp;ldquo;bit&amp;rdquo; more complicated.&lt;/p&gt;
&lt;p&gt;In Bulgarian for instance the hardest thing a foreigner will face if learning the language is the &lt;code&gt;verb&lt;/code&gt;. There&amp;rsquo;s even a story about a famous Bulgarian linguist stating that &amp;ldquo;the verb is the elephant of Bulgarian grammar&amp;rdquo;. It&amp;rsquo;s very complex with a lot of nuances. In other languages you will have trouble with word pronunciation or the way a word is written and the way it&amp;rsquo;s spoken. A third problem might be that many words can have multiple meanings depending on the context. The list goes on and on.&lt;/p&gt;
&lt;p&gt;In Chinese, the writing system is the most complicated thing to learn by far.&lt;/p&gt;
&lt;p&gt;Learning a new language is never easy, but the barrier to entry is much much lower when you only have to learn 24/30 symbols with which you can form words and sentences. This is the benefit of languages that use alphabets.&lt;/p&gt;
&lt;p&gt;Chinese is on a whole different level. I don&amp;rsquo;t think it&amp;rsquo;s even fair to say level. It&amp;rsquo;s on a whole different dimension entirely! It&amp;rsquo;s by far the most different and has the highest barrier of entry for a native speaker of an Indo-European language. Perhaps it&amp;rsquo;s the hardest to learn by a representative of every other major language family as well. That &lt;code&gt;Great Wall of Characters&lt;/code&gt; I mentioned at the start is safeguarding everyone in its borders from the outside world.&lt;/p&gt;
&lt;p&gt;For me reading combines attaining vocabulary and comprehension, so for me to be able to say that I can read Chinese then I&amp;rsquo;ll have to know 8105 characters &lt;sup id=&#34;fnref:3&#34;&gt;&lt;a href=&#34;#fn:3&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;3&lt;/a&gt;&lt;/sup&gt;. Like the authors say that in itself is &lt;code&gt;a forbidding obstacle&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;It has taken me years of trying and failing to come to the conclusion of the authors which is that it&amp;rsquo;s probably a good idea to start with the hardest part - the abstract characters themselves. Not concerning myself with pronunciations or grammar, but on pure character learning.&lt;/p&gt;
&lt;p&gt;As a Software Engineer I&amp;rsquo;m very logical and methodical in my work. I always try to break a problem down to the smallest possible logical unit, but it never occurred to me to look at language learning in such a way. I know it seems obvious, but the effects of my sudden realization were profound. I began following the Heisig method diligently and 31 days later I knew 1500 Chinese characters. And this was with me spending less than 2 hours a day on this endeavor while working fulltime from home (COVID-19).&lt;/p&gt;
&lt;p&gt;If you begin methodically and follow the method diligently my own data confirms that it&amp;rsquo;s possible to learn 1500 Chinese characters in a month.&lt;/p&gt;
&lt;p&gt;Perhaps you&amp;rsquo;re still not convinced, but I hope to change your mind in the next section!&lt;/p&gt;
&lt;h2 id=&#34;cold-hard-data&#34;&gt;Cold Hard Data&lt;/h2&gt;
&lt;p&gt;I know that probably you&amp;rsquo;re anxious at this point just to see the proof for my claims, but I want to share some light on the tools I&amp;rsquo;ve used and some on my previous Chinese character knowledge.&lt;/p&gt;
&lt;p&gt;I&amp;rsquo;ve tried to learn Chinese characters many times during the years. Some of the 1500 characters I encountered in the book I already knew. However, I followed the authors remarks in that specific case very carefully and I studied them again with the method completely for every character even if I knew it from before. I&amp;rsquo;d guess I probably knew around 100 of the characters I encountered and most of them were rather basic nouns for which it&amp;rsquo;s going to be easy to create a mental image either way.&lt;/p&gt;
&lt;p&gt;I also know the rules for stroke order of Chinese characters very well and I didn&amp;rsquo;t have any trouble with that having written most characters only 1 time when studying them. During reviews I&amp;rsquo;ve not written the characters over and over again which will defeat the purpose of following the method.&lt;/p&gt;
&lt;p&gt;My review cards have only the &lt;code&gt;keyword&lt;/code&gt; as an indication on them and it was part of my review to recall the &lt;code&gt;primitives&lt;/code&gt; and the shape of the character. If both of these were correct and I could clearly see the character in my mind&amp;rsquo;s eye, then I deemed the review successful. If some &lt;code&gt;primitives&lt;/code&gt; were missing or the position of an element was at the wrong place I considered that a mistake and marked it as such in Pleco (more on Pleco below).&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;A copy of &lt;code&gt;Remembering Simplified Hanzi&lt;/code&gt; - To me traditional Chinese characters look more beautiful and aesthetically pleasing, but in the interest of pragmatism I&amp;rsquo;ve chosen to learn simplified. They are simply more widespread. In my review software I see the simplified form and the traditional form as well and while reviewing I&amp;rsquo;ve already started to recognize and remember the shapes of some of the traditional characters. Take that information as you will.&lt;/li&gt;
&lt;li&gt;Pleco - This app is going to be by far the best software you can buy if you&amp;rsquo;re learning Chinese. It&amp;rsquo;s worth every penny. It&amp;rsquo;s a dictionary, stroke order animator, example sentences, OCR and many more features. Every module is worth the add-on price. I&amp;rsquo;ve used Pleco&amp;rsquo;s SRS (Spaced Repetition System) for my daily reviews. I have found a full card list for both tomes of Remembering Simplified Hanzi &lt;a href=&#34;https://www.plecoforums.com/threads/heisigs-remembering-simplified-hanzi-1-2.3114/&#34;&gt;here&lt;/a&gt;. &lt;strong&gt;BE WARNED&lt;/strong&gt; however that I&amp;rsquo;ve found an ordering issue that I&amp;rsquo;ve had to fix myself. In &lt;code&gt;Lesson 30&lt;/code&gt; of the card list, you&amp;rsquo;ll see two characters that in actuality will appear much later in the book. Both &lt;code&gt;用&lt;/code&gt; with frame number [971] and &lt;code&gt;确&lt;/code&gt; [972] have to be in &lt;code&gt;Lesson 47&lt;/code&gt; at frame numbers [1361] and [1362] respectively. Until then every character frame between lessons 30 and 47 is off by 2! &lt;a href=&#34;https://gist.github.com/underscoreHao/176fc3904d384155a041aa8a0778f494&#34;&gt;I&amp;rsquo;m giving a link to my own fixed list&lt;/a&gt; which you can import in Pleco, but keep in mind that I don&amp;rsquo;t know if there&amp;rsquo;s a similar issue for the second book lists at this time.&lt;/li&gt;
&lt;li&gt;A piece of paper and a pen - write characters only once and you&amp;rsquo;ll remember them forever! Feels like magic!&lt;/li&gt;
&lt;li&gt;Calm mind - your brain is going to be the most important thing with this method (shocker, I know). I&amp;rsquo;ve done my studying in a very quiet and calm environment while in an extremely focused state. On days when I had too much work and felt tired or did my study session late you&amp;rsquo;ll see in the results that my performance was less than satisfactory (for example day 20 in the tables below). Actually I think if it wasn&amp;rsquo;t for day 20 I would&amp;rsquo;ve probably finished in less than 30 days :)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;How have I structured my study plan? Essentially I&amp;rsquo;ve locked 3 slots during the day for reviews. One in the morning, one at noon and one in the evening. In each of these slots I did all reviews that Pleco gave me! My study slot varied between noon (in my lunch break from work) and evening for the most part, but the best results I got when studying in the morning before starting work.&lt;/p&gt;
&lt;p&gt;A final word on the way I kept timekeeping. I started a timer the moment I opened the book for study and stopped said timer the moment I closed the book. The reviews were timed by Pleco itself, so I&amp;rsquo;ve just combined both times to get the total.&lt;/p&gt;
&lt;p&gt;So without further ado in this very long article already, let me finally show you some numbers and my actual review of the method.&lt;/p&gt;
&lt;h3 id=&#34;time-data&#34;&gt;Time Data&lt;/h3&gt;
&lt;p&gt;In 31 consecutive days I&amp;rsquo;ve spent:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;38.72 hours&lt;/code&gt; in total of studying + reviewing&lt;/li&gt;
&lt;li&gt;&lt;code&gt;27.965 hours&lt;/code&gt; for studying&lt;/li&gt;
&lt;li&gt;&lt;code&gt;10.759 hours&lt;/code&gt; for reviewing&lt;/li&gt;
&lt;li&gt;&lt;code&gt;1.249 hours&lt;/code&gt; on average per day for studying + reviewing&lt;/li&gt;
&lt;li&gt;&lt;code&gt;99.673 seconds&lt;/code&gt; on average per character&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;fig-11---time-spent-learningreviewing-for-31-days&#34;&gt;Fig 1.1 - Time Spent learning/reviewing for 31 days&lt;/h4&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Day&lt;/th&gt;
&lt;th&gt;New Characters&lt;/th&gt;
&lt;th&gt;SPC (Seconds Per Character)&lt;/th&gt;
&lt;th&gt;Time&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;50&lt;/td&gt;
&lt;td&gt;34.5&lt;/td&gt;
&lt;td&gt;Time Spent Studying&lt;/td&gt;
&lt;td&gt;24:30 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Reviewing&lt;/td&gt;
&lt;td&gt;4:15 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Total&lt;/td&gt;
&lt;td&gt;28:45 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;58&lt;/td&gt;
&lt;td&gt;44&lt;/td&gt;
&lt;td&gt;Time Spent Studying&lt;/td&gt;
&lt;td&gt;35:53 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Reviewing&lt;/td&gt;
&lt;td&gt;6:40 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Total&lt;/td&gt;
&lt;td&gt;42:33 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;71&lt;/td&gt;
&lt;td&gt;59.4&lt;/td&gt;
&lt;td&gt;Time Spent Studying&lt;/td&gt;
&lt;td&gt;60:07 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Reviewing&lt;/td&gt;
&lt;td&gt;10:15 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Total&lt;/td&gt;
&lt;td&gt;70:22 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;58&lt;/td&gt;
&lt;td&gt;56.8&lt;/td&gt;
&lt;td&gt;Time Spent Studying&lt;/td&gt;
&lt;td&gt;45:01 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Reviewing&lt;/td&gt;
&lt;td&gt;9:54 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Total&lt;/td&gt;
&lt;td&gt;54:55 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;50&lt;/td&gt;
&lt;td&gt;70.2&lt;/td&gt;
&lt;td&gt;Time Spent Studying&lt;/td&gt;
&lt;td&gt;51:03 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Reviewing&lt;/td&gt;
&lt;td&gt;7:31 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Total&lt;/td&gt;
&lt;td&gt;58:34 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;td&gt;50&lt;/td&gt;
&lt;td&gt;76.1&lt;/td&gt;
&lt;td&gt;Time Spent Studying&lt;/td&gt;
&lt;td&gt;44:50 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Reviewing&lt;/td&gt;
&lt;td&gt;18:37 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Total&lt;/td&gt;
&lt;td&gt;63:27 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;7&lt;/td&gt;
&lt;td&gt;22&lt;/td&gt;
&lt;td&gt;95.6&lt;/td&gt;
&lt;td&gt;Time Spent Studying&lt;/td&gt;
&lt;td&gt;16:03 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Reviewing&lt;/td&gt;
&lt;td&gt;19:01 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Total&lt;/td&gt;
&lt;td&gt;35:04 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;41&lt;/td&gt;
&lt;td&gt;71.8&lt;/td&gt;
&lt;td&gt;Time Spent Studying&lt;/td&gt;
&lt;td&gt;40:42 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Reviewing&lt;/td&gt;
&lt;td&gt;8:24 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Total&lt;/td&gt;
&lt;td&gt;49:06 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;9&lt;/td&gt;
&lt;td&gt;53&lt;/td&gt;
&lt;td&gt;80.4&lt;/td&gt;
&lt;td&gt;Time Spent Studying&lt;/td&gt;
&lt;td&gt;46:53 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Reviewing&lt;/td&gt;
&lt;td&gt;24:12 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Total&lt;/td&gt;
&lt;td&gt;71:05 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;10&lt;/td&gt;
&lt;td&gt;52&lt;/td&gt;
&lt;td&gt;71.5&lt;/td&gt;
&lt;td&gt;Time Spent Studying&lt;/td&gt;
&lt;td&gt;40:39 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Reviewing&lt;/td&gt;
&lt;td&gt;21:22 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Total&lt;/td&gt;
&lt;td&gt;62:01 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;11&lt;/td&gt;
&lt;td&gt;42&lt;/td&gt;
&lt;td&gt;91.5&lt;/td&gt;
&lt;td&gt;Time Spent Studying&lt;/td&gt;
&lt;td&gt;43:37 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Reviewing&lt;/td&gt;
&lt;td&gt;20:29 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Total&lt;/td&gt;
&lt;td&gt;64:06 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;12&lt;/td&gt;
&lt;td&gt;37&lt;/td&gt;
&lt;td&gt;109.6&lt;/td&gt;
&lt;td&gt;Time Spent Studying&lt;/td&gt;
&lt;td&gt;39:00 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Reviewing&lt;/td&gt;
&lt;td&gt;28:37 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Total&lt;/td&gt;
&lt;td&gt;67:37 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;13&lt;/td&gt;
&lt;td&gt;49&lt;/td&gt;
&lt;td&gt;60.5&lt;/td&gt;
&lt;td&gt;Time Spent Studying&lt;/td&gt;
&lt;td&gt;48:47 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Reviewing&lt;/td&gt;
&lt;td&gt;00:12 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Total&lt;/td&gt;
&lt;td&gt;49:27 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;14&lt;/td&gt;
&lt;td&gt;55&lt;/td&gt;
&lt;td&gt;81.9&lt;/td&gt;
&lt;td&gt;Time Spent Studying&lt;/td&gt;
&lt;td&gt;54:06 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Reviewing&lt;/td&gt;
&lt;td&gt;21:00 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Total&lt;/td&gt;
&lt;td&gt;75:06 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;15&lt;/td&gt;
&lt;td&gt;45&lt;/td&gt;
&lt;td&gt;135.2&lt;/td&gt;
&lt;td&gt;Time Spent Studying&lt;/td&gt;
&lt;td&gt;55:42 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Reviewing&lt;/td&gt;
&lt;td&gt;45:42 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Total&lt;/td&gt;
&lt;td&gt;101:24 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;16&lt;/td&gt;
&lt;td&gt;29&lt;/td&gt;
&lt;td&gt;153.5&lt;/td&gt;
&lt;td&gt;Time Spent Studying&lt;/td&gt;
&lt;td&gt;34:24 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Reviewing&lt;/td&gt;
&lt;td&gt;39:50 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Total&lt;/td&gt;
&lt;td&gt;74:14 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;17&lt;/td&gt;
&lt;td&gt;31&lt;/td&gt;
&lt;td&gt;103.7&lt;/td&gt;
&lt;td&gt;Time Spent Studying&lt;/td&gt;
&lt;td&gt;35:35 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Reviewing&lt;/td&gt;
&lt;td&gt;18:01 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Total&lt;/td&gt;
&lt;td&gt;53:36 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;18&lt;/td&gt;
&lt;td&gt;60&lt;/td&gt;
&lt;td&gt;105&lt;/td&gt;
&lt;td&gt;Time Spent Studying&lt;/td&gt;
&lt;td&gt;80:00 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Reviewing&lt;/td&gt;
&lt;td&gt;25:52 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Total&lt;/td&gt;
&lt;td&gt;120:52 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;19&lt;/td&gt;
&lt;td&gt;47&lt;/td&gt;
&lt;td&gt;159.2&lt;/td&gt;
&lt;td&gt;Time Spent Studying&lt;/td&gt;
&lt;td&gt;60:31 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Reviewing&lt;/td&gt;
&lt;td&gt;64:14 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Total&lt;/td&gt;
&lt;td&gt;124:45 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;td&gt;24&lt;/td&gt;
&lt;td&gt;360.3&lt;/td&gt;
&lt;td&gt;Time Spent Studying&lt;/td&gt;
&lt;td&gt;83:45 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Reviewing&lt;/td&gt;
&lt;td&gt;60:24 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Total&lt;/td&gt;
&lt;td&gt;144:09 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;21&lt;/td&gt;
&lt;td&gt;47&lt;/td&gt;
&lt;td&gt;109&lt;/td&gt;
&lt;td&gt;Time Spent Studying&lt;/td&gt;
&lt;td&gt;60:21 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Reviewing&lt;/td&gt;
&lt;td&gt;25:05 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Total&lt;/td&gt;
&lt;td&gt;85:26 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;22&lt;/td&gt;
&lt;td&gt;55&lt;/td&gt;
&lt;td&gt;99.8&lt;/td&gt;
&lt;td&gt;Time Spent Studying&lt;/td&gt;
&lt;td&gt;64:31 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Reviewing&lt;/td&gt;
&lt;td&gt;26:58 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Total&lt;/td&gt;
&lt;td&gt;91:29 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;23&lt;/td&gt;
&lt;td&gt;75&lt;/td&gt;
&lt;td&gt;83.25&lt;/td&gt;
&lt;td&gt;Time Spent Studying&lt;/td&gt;
&lt;td&gt;94:10 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Reviewing&lt;/td&gt;
&lt;td&gt;9:54 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Total&lt;/td&gt;
&lt;td&gt;104:04 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;24&lt;/td&gt;
&lt;td&gt;59&lt;/td&gt;
&lt;td&gt;100.86&lt;/td&gt;
&lt;td&gt;Time Spent Studying&lt;/td&gt;
&lt;td&gt;87:19 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Reviewing&lt;/td&gt;
&lt;td&gt;11:52 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Total&lt;/td&gt;
&lt;td&gt;99:11 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;25&lt;/td&gt;
&lt;td&gt;59&lt;/td&gt;
&lt;td&gt;102.86&lt;/td&gt;
&lt;td&gt;Time Spent Studying&lt;/td&gt;
&lt;td&gt;75:49 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Reviewing&lt;/td&gt;
&lt;td&gt;25:20 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Total&lt;/td&gt;
&lt;td&gt;101:09 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;26&lt;/td&gt;
&lt;td&gt;41&lt;/td&gt;
&lt;td&gt;84.58&lt;/td&gt;
&lt;td&gt;Time Spent Studying&lt;/td&gt;
&lt;td&gt;50:12 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Reviewing&lt;/td&gt;
&lt;td&gt;7:36 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Total&lt;/td&gt;
&lt;td&gt;57:48 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;27&lt;/td&gt;
&lt;td&gt;44&lt;/td&gt;
&lt;td&gt;95.75&lt;/td&gt;
&lt;td&gt;Time Spent Studying&lt;/td&gt;
&lt;td&gt;53:18 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Reviewing&lt;/td&gt;
&lt;td&gt;16:55 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Total&lt;/td&gt;
&lt;td&gt;70:13 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;28&lt;/td&gt;
&lt;td&gt;54&lt;/td&gt;
&lt;td&gt;96.74&lt;/td&gt;
&lt;td&gt;Time Spent Studying&lt;/td&gt;
&lt;td&gt;62:09 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Reviewing&lt;/td&gt;
&lt;td&gt;24:55 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Total&lt;/td&gt;
&lt;td&gt;87:04 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;29&lt;/td&gt;
&lt;td&gt;43&lt;/td&gt;
&lt;td&gt;97.09&lt;/td&gt;
&lt;td&gt;Time Spent Studying&lt;/td&gt;
&lt;td&gt;50:49 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Reviewing&lt;/td&gt;
&lt;td&gt;18:46 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Total&lt;/td&gt;
&lt;td&gt;69:35 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;30&lt;/td&gt;
&lt;td&gt;52&lt;/td&gt;
&lt;td&gt;101.86&lt;/td&gt;
&lt;td&gt;Time Spent Studying&lt;/td&gt;
&lt;td&gt;76:50 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Reviewing&lt;/td&gt;
&lt;td&gt;11:27 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Total&lt;/td&gt;
&lt;td&gt;88:17 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;31&lt;/td&gt;
&lt;td&gt;48&lt;/td&gt;
&lt;td&gt;96.41&lt;/td&gt;
&lt;td&gt;Time Spent Studying&lt;/td&gt;
&lt;td&gt;65:23 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Reviewing&lt;/td&gt;
&lt;td&gt;11:45 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Time Spent Total&lt;/td&gt;
&lt;td&gt;77:08 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;character-data&#34;&gt;Character Data&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;1500&lt;/code&gt; encountered characters (the entirety of the &lt;code&gt;Remembering Simplified Hanzi&lt;/code&gt; book)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;48.38 CPD&lt;/code&gt; (Characters Per Day) on average&lt;/li&gt;
&lt;li&gt;&lt;code&gt;95%&lt;/code&gt; average success rate from Pleco reviews&lt;/li&gt;
&lt;li&gt;&lt;code&gt;2867&lt;/code&gt; character reviews in total in the course of 31 days&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;fig-22---characters-per-day-studied-and-review-results&#34;&gt;Fig 2.2 - Characters per day studied and review results&lt;/h4&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Day&lt;/th&gt;
&lt;th&gt;New Characters&lt;/th&gt;
&lt;th&gt;Total Encountered Characters&lt;/th&gt;
&lt;th&gt;Daily Reviews&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;50&lt;/td&gt;
&lt;td&gt;50&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Correct&lt;/td&gt;
&lt;td&gt;Incorrect&lt;/td&gt;
&lt;td&gt;Average Score&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Morning Slot&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Noon Slot&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Evening Slot&lt;/td&gt;
&lt;td&gt;50&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;57&lt;/td&gt;
&lt;td&gt;107&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Correct&lt;/td&gt;
&lt;td&gt;Incorrect&lt;/td&gt;
&lt;td&gt;Average Score&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Morning Slot&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Noon Slot&lt;/td&gt;
&lt;td&gt;57&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Evening Slot&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;71&lt;/td&gt;
&lt;td&gt;178&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Correct&lt;/td&gt;
&lt;td&gt;Incorrect&lt;/td&gt;
&lt;td&gt;Average Score&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Morning Slot&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Noon Slot&lt;/td&gt;
&lt;td&gt;71&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Evening Slot&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;58&lt;/td&gt;
&lt;td&gt;236&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Correct&lt;/td&gt;
&lt;td&gt;Incorrect&lt;/td&gt;
&lt;td&gt;Average Score&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Morning Slot&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Noon Slot&lt;/td&gt;
&lt;td&gt;58&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Evening Slot&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;50&lt;/td&gt;
&lt;td&gt;286&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Correct&lt;/td&gt;
&lt;td&gt;Incorrect&lt;/td&gt;
&lt;td&gt;Average Score&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Morning Slot&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Noon Slot&lt;/td&gt;
&lt;td&gt;50&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Evening Slot&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;td&gt;50&lt;/td&gt;
&lt;td&gt;336&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Correct&lt;/td&gt;
&lt;td&gt;Incorrect&lt;/td&gt;
&lt;td&gt;Average Score&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Morning Slot&lt;/td&gt;
&lt;td&gt;50&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Noon Slot&lt;/td&gt;
&lt;td&gt;86&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Evening Slot&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;7&lt;/td&gt;
&lt;td&gt;22&lt;/td&gt;
&lt;td&gt;358&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Correct&lt;/td&gt;
&lt;td&gt;Incorrect&lt;/td&gt;
&lt;td&gt;Average Score&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Morning Slot&lt;/td&gt;
&lt;td&gt;21&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;90%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Noon Slot&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Evening Slot&lt;/td&gt;
&lt;td&gt;92&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;41&lt;/td&gt;
&lt;td&gt;399&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Correct&lt;/td&gt;
&lt;td&gt;Incorrect&lt;/td&gt;
&lt;td&gt;Average Score&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Morning Slot&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Noon Slot&lt;/td&gt;
&lt;td&gt;43&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Evening Slot&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;9&lt;/td&gt;
&lt;td&gt;53&lt;/td&gt;
&lt;td&gt;452&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Correct&lt;/td&gt;
&lt;td&gt;Incorrect&lt;/td&gt;
&lt;td&gt;Average Score&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Morning Slot&lt;/td&gt;
&lt;td&gt;59&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Noon Slot&lt;/td&gt;
&lt;td&gt;49&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;98%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Evening Slot&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;10&lt;/td&gt;
&lt;td&gt;52&lt;/td&gt;
&lt;td&gt;504&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Correct&lt;/td&gt;
&lt;td&gt;Incorrect&lt;/td&gt;
&lt;td&gt;Average Score&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Morning Slot&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Noon Slot&lt;/td&gt;
&lt;td&gt;104&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;99%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Evening Slot&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;11&lt;/td&gt;
&lt;td&gt;42&lt;/td&gt;
&lt;td&gt;546&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Correct&lt;/td&gt;
&lt;td&gt;Incorrect&lt;/td&gt;
&lt;td&gt;Average Score&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Morning Slot&lt;/td&gt;
&lt;td&gt;48&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;96%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Noon Slot&lt;/td&gt;
&lt;td&gt;43&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Evening Slot&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;12&lt;/td&gt;
&lt;td&gt;37&lt;/td&gt;
&lt;td&gt;583&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Correct&lt;/td&gt;
&lt;td&gt;Incorrect&lt;/td&gt;
&lt;td&gt;Average Score&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Morning Slot&lt;/td&gt;
&lt;td&gt;22&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;95%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Noon Slot&lt;/td&gt;
&lt;td&gt;42&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;93%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Evening Slot&lt;/td&gt;
&lt;td&gt;37&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;94%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;13&lt;/td&gt;
&lt;td&gt;49&lt;/td&gt;
&lt;td&gt;632&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Correct&lt;/td&gt;
&lt;td&gt;Incorrect&lt;/td&gt;
&lt;td&gt;Average Score&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Morning Slot&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Noon Slot&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Evening Slot&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;14&lt;/td&gt;
&lt;td&gt;55&lt;/td&gt;
&lt;td&gt;687&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Correct&lt;/td&gt;
&lt;td&gt;Incorrect&lt;/td&gt;
&lt;td&gt;Average Score&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Morning Slot&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Noon Slot&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Evening Slot&lt;/td&gt;
&lt;td&gt;101&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;98%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;15&lt;/td&gt;
&lt;td&gt;45&lt;/td&gt;
&lt;td&gt;732&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Correct&lt;/td&gt;
&lt;td&gt;Incorrect&lt;/td&gt;
&lt;td&gt;Average Score&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Morning Slot&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Noon Slot&lt;/td&gt;
&lt;td&gt;97&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;92%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Evening Slot&lt;/td&gt;
&lt;td&gt;60&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;16&lt;/td&gt;
&lt;td&gt;29&lt;/td&gt;
&lt;td&gt;761&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Correct&lt;/td&gt;
&lt;td&gt;Incorrect&lt;/td&gt;
&lt;td&gt;Average Score&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Morning Slot&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Noon Slot&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Evening Slot&lt;/td&gt;
&lt;td&gt;137&lt;/td&gt;
&lt;td&gt;14&lt;/td&gt;
&lt;td&gt;90%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;17&lt;/td&gt;
&lt;td&gt;31&lt;/td&gt;
&lt;td&gt;792&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Correct&lt;/td&gt;
&lt;td&gt;Incorrect&lt;/td&gt;
&lt;td&gt;Average Score&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Morning Slot&lt;/td&gt;
&lt;td&gt;36&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;94%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Noon Slot&lt;/td&gt;
&lt;td&gt;31&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Evening Slot&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;18&lt;/td&gt;
&lt;td&gt;60&lt;/td&gt;
&lt;td&gt;852&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Correct&lt;/td&gt;
&lt;td&gt;Incorrect&lt;/td&gt;
&lt;td&gt;Average Score&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Morning Slot&lt;/td&gt;
&lt;td&gt;104&lt;/td&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;td&gt;94%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Noon Slot&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Evening Slot&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;19&lt;/td&gt;
&lt;td&gt;47&lt;/td&gt;
&lt;td&gt;899&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Correct&lt;/td&gt;
&lt;td&gt;Incorrect&lt;/td&gt;
&lt;td&gt;Average Score&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Morning Slot&lt;/td&gt;
&lt;td&gt;14&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;87%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Noon Slot&lt;/td&gt;
&lt;td&gt;86&lt;/td&gt;
&lt;td&gt;7&lt;/td&gt;
&lt;td&gt;92%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Evening Slot&lt;/td&gt;
&lt;td&gt;108&lt;/td&gt;
&lt;td&gt;9&lt;/td&gt;
&lt;td&gt;92%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;td&gt;24&lt;/td&gt;
&lt;td&gt;923&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Correct&lt;/td&gt;
&lt;td&gt;Incorrect&lt;/td&gt;
&lt;td&gt;Average Score&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Morning Slot&lt;/td&gt;
&lt;td&gt;38&lt;/td&gt;
&lt;td&gt;16&lt;/td&gt;
&lt;td&gt;70%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Noon Slot&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Evening Slot&lt;/td&gt;
&lt;td&gt;71&lt;/td&gt;
&lt;td&gt;19&lt;/td&gt;
&lt;td&gt;78%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;21&lt;/td&gt;
&lt;td&gt;47&lt;/td&gt;
&lt;td&gt;970&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Correct&lt;/td&gt;
&lt;td&gt;Incorrect&lt;/td&gt;
&lt;td&gt;Average Score&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Morning Slot&lt;/td&gt;
&lt;td&gt;12&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Noon Slot&lt;/td&gt;
&lt;td&gt;12&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;75%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Evening Slot&lt;/td&gt;
&lt;td&gt;30&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;88%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;22&lt;/td&gt;
&lt;td&gt;55&lt;/td&gt;
&lt;td&gt;1025&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Correct&lt;/td&gt;
&lt;td&gt;Incorrect&lt;/td&gt;
&lt;td&gt;Average Score&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Morning Slot&lt;/td&gt;
&lt;td&gt;56&lt;/td&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;91%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Noon Slot&lt;/td&gt;
&lt;td&gt;46&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;97%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Evening Slot&lt;/td&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;95%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;23&lt;/td&gt;
&lt;td&gt;75&lt;/td&gt;
&lt;td&gt;1100&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Correct&lt;/td&gt;
&lt;td&gt;Incorrect&lt;/td&gt;
&lt;td&gt;Average Score&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Morning Slot&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Noon Slot&lt;/td&gt;
&lt;td&gt;58&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Evening Slot&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;24&lt;/td&gt;
&lt;td&gt;59&lt;/td&gt;
&lt;td&gt;1159&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Correct&lt;/td&gt;
&lt;td&gt;Incorrect&lt;/td&gt;
&lt;td&gt;Average Score&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Morning Slot&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Noon Slot&lt;/td&gt;
&lt;td&gt;22&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Evening Slot&lt;/td&gt;
&lt;td&gt;38&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;25&lt;/td&gt;
&lt;td&gt;59&lt;/td&gt;
&lt;td&gt;1218&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Correct&lt;/td&gt;
&lt;td&gt;Incorrect&lt;/td&gt;
&lt;td&gt;Average Score&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Morning Slot&lt;/td&gt;
&lt;td&gt;50&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;98%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Noon Slot&lt;/td&gt;
&lt;td&gt;97&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;97%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Evening Slot&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;26&lt;/td&gt;
&lt;td&gt;41&lt;/td&gt;
&lt;td&gt;1259&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Correct&lt;/td&gt;
&lt;td&gt;Incorrect&lt;/td&gt;
&lt;td&gt;Average Score&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Morning Slot&lt;/td&gt;
&lt;td&gt;10&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;90%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Noon Slot&lt;/td&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;95%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Evening Slot&lt;/td&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;95%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;27&lt;/td&gt;
&lt;td&gt;44&lt;/td&gt;
&lt;td&gt;1303&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Correct&lt;/td&gt;
&lt;td&gt;Incorrect&lt;/td&gt;
&lt;td&gt;Average Score&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Morning Slot&lt;/td&gt;
&lt;td&gt;69&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;97%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Noon Slot&lt;/td&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;85%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Evening Slot&lt;/td&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;71%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;28&lt;/td&gt;
&lt;td&gt;54&lt;/td&gt;
&lt;td&gt;1357&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Correct&lt;/td&gt;
&lt;td&gt;Incorrect&lt;/td&gt;
&lt;td&gt;Average Score&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Morning Slot&lt;/td&gt;
&lt;td&gt;73&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;97%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Noon Slot&lt;/td&gt;
&lt;td&gt;34&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Evening Slot&lt;/td&gt;
&lt;td&gt;11&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;29&lt;/td&gt;
&lt;td&gt;43&lt;/td&gt;
&lt;td&gt;1400&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Correct&lt;/td&gt;
&lt;td&gt;Incorrect&lt;/td&gt;
&lt;td&gt;Average Score&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Morning Slot&lt;/td&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;83%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Noon Slot&lt;/td&gt;
&lt;td&gt;58&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;98%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Evening Slot&lt;/td&gt;
&lt;td&gt;10&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;83%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;30&lt;/td&gt;
&lt;td&gt;52&lt;/td&gt;
&lt;td&gt;1452&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Correct&lt;/td&gt;
&lt;td&gt;Incorrect&lt;/td&gt;
&lt;td&gt;Average Score&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Morning Slot&lt;/td&gt;
&lt;td&gt;21&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;91%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Noon Slot&lt;/td&gt;
&lt;td&gt;7&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Evening Slot&lt;/td&gt;
&lt;td&gt;12&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;31&lt;/td&gt;
&lt;td&gt;48&lt;/td&gt;
&lt;td&gt;1500&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Correct&lt;/td&gt;
&lt;td&gt;Incorrect&lt;/td&gt;
&lt;td&gt;Average Score&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Morning Slot&lt;/td&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Noon Slot&lt;/td&gt;
&lt;td&gt;34&lt;/td&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;td&gt;85%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;Evening Slot&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;100%&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;the-heisig-method&#34;&gt;The Heisig Method&lt;/h2&gt;
&lt;p&gt;So as you see, I&amp;rsquo;ve had a transformative experience in the past month. I went from a person that had tried to learn Chinese characters for many years to someone finally finding a method that works. It&amp;rsquo;s an interesting question if &lt;code&gt;The Heisig Method&lt;/code&gt; will work for you. But it definitely worked for me. In this section I&amp;rsquo;m going to describe some interesting points and some pain points I&amp;rsquo;ve found along the way.&lt;/p&gt;
&lt;p&gt;First of all I&amp;rsquo;d like to say that I followed the advice in the book and I was learning just the characters as isolated pictographic units. That means I only studied the &lt;code&gt;keyword + primitives&lt;/code&gt; and the ability to recall how to write the character based on them. That&amp;rsquo;s as far as I went when active learning is concerned. As I mentioned in the previous section I reviewed based on the given &lt;code&gt;keyword&lt;/code&gt; alone because that was the authors advice. I saw pronunciation on the answer side of my cards and I repeat it, but I didn&amp;rsquo;t do anything more. Same goes for the traditional form of the characters. I saw them on the answer side, but I made no effort to memorize them.&lt;/p&gt;
&lt;p&gt;The reasoning for that is described very well in the introduction of the book. I agree with it completely at this point (as stated before), especially when taking into account my previous language learning experience. Learning characters + pronunciation + grammar + listening at the same time seems to me like a huge waste of time and very hard and time consuming. There&amp;rsquo;s too much ambiguity in the syllables. The authors tell us:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;For example, even an ordinary pocket dictionary of Mandarin lists some 60 characters that are pronounced yi in one or another of its tonal variants, with at least 30 distinct characters in the fourth tone alone. &lt;sup id=&#34;fnref4:2&#34;&gt;&lt;a href=&#34;#fn:2&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;2&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I&amp;rsquo;m not a native speaker of the language and I&amp;rsquo;m not surrounded by it. I don&amp;rsquo;t have time to do it the way Chinese people do it.&lt;/p&gt;
&lt;p&gt;I, just like the authors agree that this method has drawbacks especially when you consider that most words in Chinese use 2 or 3 characters. BUT this method is not for learning vocabulary! It&amp;rsquo;s for learning &lt;code&gt;how to write&lt;/code&gt; and &lt;code&gt;how to remember to write&lt;/code&gt; 3000 Chinese characters (2 books of 1500 chars).&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s say that I keep at this current rate and finish the second book in around 2 months time. Then I can actually start to read even though I won&amp;rsquo;t understand anything (the vocabulary problem). But just the act of recognition when you encounter a foreign text is a huge boon to any learning. I would be able to delve deeper into the grammar and just learn vocabulary without wasting time on learning the characters I encounter. It&amp;rsquo;s going to help me to do much more focused learning based on specific topics that I want to learn about. I&amp;rsquo;ll also be able to assign the pronunciations to the characters and practice them while listening. Like the authors have said, characters remove the ambiguity of the pronunciation.&lt;/p&gt;
&lt;p&gt;Even then my results show that if you can focus for deep work for 2 hours a day you can learn 50 characters each day. If we extend that for 4 hours without outside interference theoretically it should be possible to be able to learn a 100 characters a day! I&amp;rsquo;m not sure how does that look like, but if I had the time I&amp;rsquo;d certainly try it!&lt;/p&gt;
&lt;p&gt;At this stage I&amp;rsquo;m a strong proponent of the idea that big problems like learning Chinese should be broken down into the smallest and most logical unit that works for you as an individual. The authors have completely converted me. For me that means learning how to recognize as many characters as I can at first and take everything else from there.&lt;/p&gt;
&lt;h3 id=&#34;associations-galore&#34;&gt;Associations galore&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;The Heisig Method&lt;/code&gt; is interesting to me because I have an additional challenge in the fact that I&amp;rsquo;m not a native English speaker, so some of the &lt;code&gt;keywords&lt;/code&gt; that were given were English words that I didn&amp;rsquo;t know. It wasn&amp;rsquo;t a huge number of words, but I had to check up their meanings to be able to form a clear picture.&lt;/p&gt;
&lt;p&gt;For example the keyword &lt;code&gt;resplendent&lt;/code&gt;. I don&amp;rsquo;t think I&amp;rsquo;ve encountered it anywhere during the years (or maybe I have, but just forgotten it). Once I saw the actual English meaning and how the character that&amp;rsquo;s assigned to it is built, it became clear in an instant. The character for &lt;code&gt;resplendent&lt;/code&gt; is &lt;code&gt;煌&lt;/code&gt; and is built from &lt;code&gt;火 (fire)&lt;/code&gt; + &lt;code&gt;皇 (emperor)&lt;/code&gt;. The first association that popped in my mind when I read &amp;ldquo;fire&amp;hellip; emperor&amp;rdquo; was of &lt;code&gt;Firelord Ozai&lt;/code&gt; from &lt;code&gt;The Last Airbender&lt;/code&gt;. The association in my mind was so strong that it&amp;rsquo;s one of those that I&amp;rsquo;ll never forget. In an instant I knew that I &amp;ldquo;knew&amp;rdquo; this character forever alongside the English meaning of the key word. I had a super clear mental image in my mind. Other interesting words that I didn&amp;rsquo;t really know where &lt;code&gt;auspicious&lt;/code&gt;, &lt;code&gt;adroit&lt;/code&gt; and &lt;code&gt;venerate&lt;/code&gt;. I&amp;rsquo;ve made concrete images for all of them after reading on their actual meaning. It&amp;rsquo;s nice when learning one language helps you with another and they both complement each other.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://underscorehao.net/images/fire-lord-ozai.jpg&#34;
         alt=&#34;The &amp;amp;lsquo;resplendent&amp;amp;rsquo; Fire Lord Ozai in &amp;amp;lsquo;The Last Airbender&amp;amp;rsquo; - One of the greatest animated shows ever made&#34;/&gt;&lt;figcaption&gt;
            &lt;p&gt;The &amp;lsquo;resplendent&amp;rsquo; Fire Lord Ozai in &amp;lsquo;The Last Airbender&amp;rsquo; - One of the greatest animated shows ever made&lt;/p&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;Obviously not all keywords are that easy, especially some more abstract ones where stories get a bit more involved. I even think that rote memorization of the &lt;code&gt;primitives + keyword&lt;/code&gt; themselves is still going to be a faster method than pure muscle memory training of writing the character over and over again. Maybe it&amp;rsquo;s just easy for me to create mental stories and images, but cases just like &lt;code&gt;resplendent&lt;/code&gt; are not uncommon. I just try to create an emotional response/story from the &lt;code&gt;keyword + primitives&lt;/code&gt; combination. Most characters I write only once and because I know the primitives they&amp;rsquo;re fixed in my memory. I had no trouble in remembering their stroke order or position of the elements (there are exceptions, but few and far between).&lt;/p&gt;
&lt;p&gt;Let me give another example of a &lt;code&gt;primitive&lt;/code&gt; that exists in a number of other characters and how my association with it works. The primitive &lt;code&gt;taskmaster&lt;/code&gt; is &lt;code&gt;攵&lt;/code&gt;. When I initially read that explanation I immediately thought of &lt;code&gt;Tony Soprano&lt;/code&gt;. I am a huge fan of the show so it&amp;rsquo;s an association that came very naturally to me. Tony was the boss! Let&amp;rsquo;s see how did I construct my stories with that primitive:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;攻&lt;/code&gt; - with keyword &lt;code&gt;attack&lt;/code&gt; = &lt;code&gt;I-beam&lt;/code&gt; + &lt;code&gt;taskmaster&lt;/code&gt;; Tony Soprano bashing someone&amp;rsquo;s head in with an I-beam&lt;/li&gt;
&lt;li&gt;&lt;code&gt;救&lt;/code&gt; - with keyword &lt;code&gt;rescue&lt;/code&gt; = &lt;code&gt;request&lt;/code&gt; + &lt;code&gt;taskmaster&lt;/code&gt;; Tony Soprano rushing into the pool to &lt;code&gt;rescue&lt;/code&gt; his son AJ from suicide by drowning (very poorly planned and executed on his part if I might add&amp;hellip;) while AJ is &lt;code&gt;requesting&lt;/code&gt; (left part of the character) help&lt;/li&gt;
&lt;li&gt;&lt;code&gt;敬&lt;/code&gt; - with keyword &lt;code&gt;revere&lt;/code&gt; = &lt;code&gt;flower&lt;/code&gt; + &lt;code&gt;sentence&lt;/code&gt; + &lt;code&gt;taskmaster&lt;/code&gt;; A mob goon pleading with Tony via &lt;code&gt;flowery sentences&lt;/code&gt; (left part of the character)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I know this may seem a bit graphic and gruesome, but the point here is that these images drive the point home very effectively. They create an emotional response for me and that&amp;rsquo;s why the characters were so easy to remember.&lt;/p&gt;
&lt;p&gt;And that&amp;rsquo;s how the whole method works! You start with the simplest of characters, the character for &lt;code&gt;一&lt;/code&gt; (one) and you go from there by adding more and more elements which can also become primitives to other more complicated characters. In example the character for &lt;code&gt;revere&lt;/code&gt; which I&amp;rsquo;ve shown above will become a &lt;code&gt;primitive&lt;/code&gt; in the more complex character &lt;code&gt;警&lt;/code&gt; which has the keyword &lt;code&gt;police&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;All of this is very logical and gradual! It&amp;rsquo;s like writing a computer program, where you just add different modules and libraries together and increase the abstraction and complexity with time.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://underscorehao.net/images/tony-soprano-pool.jpg&#34;
         alt=&#34;Tony Soprano as portrayed by the late great James Gandolfini&#34;/&gt;&lt;figcaption&gt;
            &lt;p&gt;Tony Soprano as portrayed by the late great James Gandolfini&lt;/p&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;I can continue on and on and make a list of the stories for every character, but you must understand that these stories work for me exactly because they&amp;rsquo;re mine. After the first couple of chapters some of the stories that the authors provided weren&amp;rsquo;t very helpful. Baseball references or some vague religious analogies in those introductory stories didn&amp;rsquo;t make too much sense to me. For those instances I&amp;rsquo;ve completely disregarded the author&amp;rsquo;s stories and created my own. And in the end that is the method - you create your own stories that evoke a strong emotion and a mental image based on your own experience.&lt;/p&gt;
&lt;h2 id=&#34;conclusion&#34;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;As final words I&amp;rsquo;d like to say that &lt;code&gt;The Heisig Method&lt;/code&gt; worked extremely well for me, but there&amp;rsquo;s no guarantee it&amp;rsquo;s going to work for you.&lt;/p&gt;
&lt;p&gt;We&amp;rsquo;re all unique and memorize things differently. With that being said though, I do think there&amp;rsquo;s a huge benefit in cracking the writing system first before you go on forward. I agree with the authors wholeheartedly on that front.&lt;/p&gt;
&lt;p&gt;I&amp;rsquo;ve seen the figures of 2200 and 4400 hours being thrown &lt;sup id=&#34;fnref:4&#34;&gt;&lt;a href=&#34;#fn:4&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;4&lt;/a&gt;&lt;/sup&gt; as the amount of hours needed for an English speaker to learn Chinese fluently. If we take even the lower figure as real, I wonder how much time they&amp;rsquo;ve used that on character learning?&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s do some simple math of how long it&amp;rsquo;s going to take you conservatively to learn the &lt;code&gt;8105&lt;/code&gt; characters given in the &lt;code&gt;Table of General Standard Chinese Characters&lt;/code&gt; if you follow my velocity of 50 characters a day. And I&amp;rsquo;m going to add another 30 minutes, so we have 2 whole hours a day.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;8105 (total characters) / 50 (characters per day) = 162.1 days ~ 6 months&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;162.1 (days) * 2 (hours) = 324.2‬ hours&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;code&gt;324.2&lt;/code&gt; hours for all characters in the course of &lt;code&gt;~6 months&lt;/code&gt;. This seems very possible to me and a very good investment of time at that. After these 6 months you&amp;rsquo;ll be free to pursue gaining vocabulary in the form of combining the characters you know into words, pronunciation and listening/speaking.&lt;/p&gt;
&lt;p&gt;And perhaps I&amp;rsquo;ll embark on that journey myself :)&lt;/p&gt;
&lt;p&gt;I thank you for your time if you&amp;rsquo;ve come down this far! I know the article is really long, but I wanted to share my experience and results exactly as they happened in the hope that this information can help other people that are having similar struggles. I&amp;rsquo;d be interested in your results if you&amp;rsquo;ve tackled character learning via the same method yourself! You can find my contact details on the footer of this page.&lt;/p&gt;
&lt;p&gt;Thank you once again!&lt;/p&gt;
&lt;div class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34;&gt;
&lt;p&gt;&lt;a href=&#34;https://ru.wikipedia.org/wiki/%D0%9C%D0%B8%D1%84%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9_%D1%81%D0%BB%D0%BE%D0%B2%D0%B0%D1%80%D1%8C#%D0%98%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5&#34;&gt;Мифологический словарь&lt;/a&gt; - Full book is linked under the &lt;code&gt;Издание&lt;/code&gt; section&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&amp;#160;&lt;a href=&#34;#fnref1:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:2&#34;&gt;
&lt;p&gt;&lt;a href=&#34;https://nirc.nanzan-u.ac.jp/en/files/2013/11/RH-S1-sample.pdf&#34;&gt;Remembering Simplified Hanzi 1: How Not to Forget the Meaning and Writing of Chinese Characters&lt;/a&gt; - pages 1-4 from the &lt;code&gt;Introduction&lt;/code&gt; chapter.&amp;#160;&lt;a href=&#34;#fnref:2&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&amp;#160;&lt;a href=&#34;#fnref1:2&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&amp;#160;&lt;a href=&#34;#fnref2:2&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&amp;#160;&lt;a href=&#34;#fnref3:2&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&amp;#160;&lt;a href=&#34;#fnref4:2&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:3&#34;&gt;
&lt;p&gt;&lt;a href=&#34;https://en.wikipedia.org/wiki/Table_of_General_Standard_Chinese_Characters&#34;&gt;Table of General Standard Chinese Characters&lt;/a&gt;&amp;#160;&lt;a href=&#34;#fnref:3&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:4&#34;&gt;
&lt;p&gt;&lt;a href=&#34;https://www.state.gov/foreign-language-training/&#34;&gt;United States Foreign Service Institute&lt;/a&gt;&amp;#160;&lt;a href=&#34;#fnref:4&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
- https://underscorehao.net/2020/05/learning-1500-chinese-characters-in-a-month-heisig-method-review/ - Copyright 2017-2023 by Pavel Danov</description>
        </item>
    
    
    
        <item>
        <title>About me</title>
        <link>https://underscorehao.net/about/</link>
        <pubDate>Fri, 20 Mar 2020 16:45:00 +0100</pubDate>
        
        <guid>https://underscorehao.net/about/</guid>
        <description>Pavel Danov https://underscorehao.net/about/ -&lt;p&gt;Hey there, I&amp;rsquo;m Pavel Danov a.k.a. &lt;strong&gt;_hao&lt;/strong&gt; or &lt;strong&gt;underscoreHao&lt;/strong&gt; (on websites that don&amp;rsquo;t support underscores). Welcome to my personal website. Here you can find about things that interest me and occupy my attention most of the time.&lt;/p&gt;
&lt;p&gt;I&amp;rsquo;m originally from Bulgaria but moved to London in 2018.&lt;/p&gt;
&lt;p&gt;My interests are too broad to list, but some honorable mentions - martial arts (been practicing for more than 20 years), film, reading books (a lot of history, politics and science).&lt;/p&gt;
&lt;p&gt;Most people that know me are aware of my love for languages, having studied to varying degrees of success - English, German, Russian and now learning Chinese. 我认识你很高兴！&lt;/p&gt;
&lt;h2 id=&#34;software-engineer&#34;&gt;Software Engineer&lt;/h2&gt;
&lt;p&gt;I&amp;rsquo;ve been occupied in the software industry professionally for a decade and I&amp;rsquo;ve been dabbling with computers since I was a child.&lt;/p&gt;
&lt;p&gt;I like to play games and I am also fond of bashing my head against the wall when trying to make them. I&amp;rsquo;m the founder of a small &lt;a href=&#34;https://vermilion.digital/&#34;&gt;game development studio&lt;/a&gt; and have a couple of projects in the pipeline including creating my own game engine.&lt;/p&gt;
&lt;p&gt;I&amp;rsquo;m also available on a contract basis. If you think I can help you with a project you can use the contact methods above to get in touch with me.&lt;/p&gt;
&lt;h2 id=&#34;about-this-site&#34;&gt;About this site&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Generated using &lt;a href=&#34;http://gohugo.io&#34;&gt;Hugo&lt;/a&gt;, a fast and modern static website engine&lt;/li&gt;
&lt;li&gt;Base theme &lt;a href=&#34;https://github.com/AmazingRise/hugo-theme-diary&#34;&gt;hugo-theme-diary&lt;/a&gt; created by &lt;a href=&#34;https://github.com/AmazingRise&#34;&gt;Rise&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Hosted on &lt;a href=&#34;http://github.com/underscorehao/underscorehao.github.io/&#34;&gt;Github Pages&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
- https://underscorehao.net/about/ - Copyright 2017-2023 by Pavel Danov</description>
        </item>
    
    
    
        <item>
        <title>Publishing to Multiple Topics in Azure Service Bus</title>
        <link>https://underscorehao.net/2020/01/publishing-to-multiple-topics-in-azure-service-bus/</link>
        <pubDate>Sat, 11 Jan 2020 19:33:48 +0000</pubDate>
        
        <guid>https://underscorehao.net/2020/01/publishing-to-multiple-topics-in-azure-service-bus/</guid>
        <description>Pavel Danov https://underscorehao.net/2020/01/publishing-to-multiple-topics-in-azure-service-bus/ -&lt;h2 id=&#34;multiple-topics&#34;&gt;Multiple topics&lt;/h2&gt;
&lt;p&gt;There are two main approaches when it comes to topics in Azure Service Bus. Depending what&amp;rsquo;s your architecture and needs you can have either:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Filtered topic&lt;/strong&gt; - this means you have only one topic for all of your event types. All publishers push messages onto that single topic. Some of the message fields and properties are then used for filtering by the subscribers since in most cases a subscriber will be interested only in certain types of messages.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Multiple topics&lt;/strong&gt; - you have multiple topics for different domain events or channels of your system. You can still leverage the filtering to have more granular control in your subscribers. You can also have topics based on priority, event types etc.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Our main concern in this post is the second use case and how to build a nice &lt;a href=&#34;https://docs.microsoft.com/en-us/dotnet/api/microsoft.azure.servicebus.topicclient?view=azure-dotnet&#34;&gt;&lt;strong&gt;&lt;code&gt;ITopicClient&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt; factory inside a .NET Core project. I&amp;rsquo;ve built my example with Azure Functions, but 99.9% of the code is completely identical to what you would do in a normal .NET Core web service.&lt;/p&gt;
&lt;h2 id=&#34;basic-setup&#34;&gt;Basic Setup&lt;/h2&gt;
&lt;p&gt;If you haven&amp;rsquo;t used &lt;a href=&#34;https://docs.microsoft.com/en-us/dotnet/api/microsoft.azure.servicebus.topicclient?view=azure-dotnet&#34;&gt;&lt;strong&gt;&lt;code&gt;ITopicClient&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt; and Azure Service Bus I recommend you read the following two articles before continuing:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.microsoft.com/en-us/azure/service-bus-messaging/service-bus-quickstart-topics-subscriptions-portal&#34;&gt;Create Azure Service Bus topics and subscriptions&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.microsoft.com/en-us/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions&#34;&gt;Getting started with Service Bus topics&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Now that we know what libraries we&amp;rsquo;ll be using we can start building our solution. The first step is to create our TopicClient which is easy enough&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; topicClient = &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; TopicClient(&lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;AzureServiceBusConnectionString&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;TopicName&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The two things we need are the ASB connection string and the topic to which we would like to publish messages.&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s get the boilerplate code that is going to be used onward out of the way first. You&amp;rsquo;ll need to have something like that in your &lt;code&gt;appsettings.json&lt;/code&gt; file&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7ee787&#34;&gt;&amp;#34;ServiceBus&amp;#34;&lt;/span&gt;: {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#7ee787&#34;&gt;&amp;#34;Endpoint&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;AsbFooBarEndpoint&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#7ee787&#34;&gt;&amp;#34;FooTopic&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;foo&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#7ee787&#34;&gt;&amp;#34;BarTopic&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;bar&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And a simple POCO that you can map it to&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#f0883e;font-weight:bold&#34;&gt;ServiceBusOptions&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt; Endpoint { &lt;span style=&#34;color:#ff7b72&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#ff7b72&#34;&gt;set&lt;/span&gt;; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt; FooTopic { &lt;span style=&#34;color:#ff7b72&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#ff7b72&#34;&gt;set&lt;/span&gt;; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt; BarTopic { &lt;span style=&#34;color:#ff7b72&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#ff7b72&#34;&gt;set&lt;/span&gt;; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Then you register your options in the startup&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;void&lt;/span&gt; BindConfigurationOptions(IServiceCollection services)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    services.Configure&amp;lt;ServiceBusOptions&amp;gt;(options =&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        Configuration.GetSection(&lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;ServiceBus&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            .Bind(options));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;the-naïve-approach&#34;&gt;The naïve approach&lt;/h2&gt;
&lt;p&gt;If we were doing the first example (filtered topic) we are pretty much done. You can register your &lt;a href=&#34;https://docs.microsoft.com/en-us/dotnet/api/microsoft.azure.servicebus.topicclient?view=azure-dotnet&#34;&gt;&lt;strong&gt;&lt;code&gt;ITopicClient&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt; as a &lt;a href=&#34;https://docs.microsoft.com/en-us/azure/service-bus-messaging/service-bus-performance-improvements#reusing-factories-and-clients&#34;&gt;&lt;strong&gt;singleton&lt;/strong&gt;&lt;/a&gt; and inject it in your DI container.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// This is the Azure Functions host builder&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// In a web service you&amp;#39;ll have the IServiceCollection&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;void&lt;/span&gt; Configure(IFunctionsHostBuilder builder)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    builder.Services.AddSingleton&amp;lt;ITopicClient&amp;gt;(x =&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; options = x.GetRequiredService&amp;lt;IOptions&amp;lt;ServiceBusOptions&amp;gt;&amp;gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; TopicClient(options.Value.Endpoint, options.Value.FooTopic);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    });
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Finally you just use the injected client to send messages to the &lt;code&gt;Foo&lt;/code&gt; topic&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// Code below uses a MediatR handler as an example&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#f0883e;font-weight:bold&#34;&gt;FooHandler&lt;/span&gt; : IRequestHandler&amp;lt;Foo, &lt;span style=&#34;color:#ff7b72&#34;&gt;bool&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;readonly&lt;/span&gt; ITopicClient topicClient;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; FooHandler(ITopicClient topicClient)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;this&lt;/span&gt;.topicClient = topicClient ?? &lt;span style=&#34;color:#ff7b72&#34;&gt;throw&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; ArgumentNullException(nameof(topicClient));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;async&lt;/span&gt; Task&amp;lt;&lt;span style=&#34;color:#ff7b72&#34;&gt;bool&lt;/span&gt;&amp;gt; Handle(Foo request, CancellationToken cancellationToken)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;if&lt;/span&gt; (request == &lt;span style=&#34;color:#ff7b72&#34;&gt;null&lt;/span&gt;) &lt;span style=&#34;color:#ff7b72&#34;&gt;throw&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; ArgumentNullException(nameof(request));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;try&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;await&lt;/span&gt; topicClient.SendAsync(request.Message);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;true&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;catch&lt;/span&gt; (Exception ex)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;false&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And that&amp;rsquo;s that. We&amp;rsquo;re done.&lt;/p&gt;
&lt;p&gt;What happens however if we have to accommodate multiple topics? Do we inject multiple topics in the service/handler? Depending on your DI container are you even able to put multiple implementations of the same interface? Do we use a bunch of if statements and introduce cyclomatic complexity for deciding which topic client we want? These are all viable questions and solutions, but one elegant answer is hidden in the next section.&lt;/p&gt;
&lt;h2 id=&#34;introducing-the-itopicclient-resolver&#34;&gt;Introducing the ITopicClient resolver&lt;/h2&gt;
&lt;p&gt;In order to solve the problem at hand I want to minimize the complexity of dealing with multiple topics. I want the usage to be as simple as when using only one just like in the previous example. So how do we do that?&lt;/p&gt;
&lt;p&gt;The first part of the problem is how to differentiate between the topic clients for each topic. We can do that by creating small wrapper classes around each client we have.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#f0883e;font-weight:bold&#34;&gt;FooClient&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;readonly&lt;/span&gt; ITopicClient TopicClient;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; FooClient(IOptions&amp;lt;ServiceBusOptions&amp;gt; options)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        TopicClient = &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; TopicClient(options.Value.Endpoint, options.Value.FooTopic);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#f0883e;font-weight:bold&#34;&gt;BarClient&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;readonly&lt;/span&gt; ITopicClient TopicClient;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; BarClient(IOptions&amp;lt;ServiceBusOptions&amp;gt; options)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        TopicClient = &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; TopicClient(options.Value.Endpoint, options.Value.BarTopic);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Now that we have our clients we are going to create a factory with the help of a &lt;code&gt;delegate&lt;/code&gt;. Based on a &lt;code&gt;key&lt;/code&gt; we&amp;rsquo;ll return the exact topic client we want when we want it!&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;Microsoft.Azure.ServiceBus&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;namespace&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;FooBarApp.Clients&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// The key can be a string, Type, enum, int - whatever you need really&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;delegate&lt;/span&gt; ITopicClient TopicResolver(&lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt; key);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The step where the magic happens is in our DI registration.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// This is the Azure Functions host builder&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// In a web service you&amp;#39;ll have the IServiceCollection&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;void&lt;/span&gt; Configure(IFunctionsHostBuilder builder)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    builder.Services.AddSingleton&amp;lt;FooClient&amp;gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    builder.Services.AddSingleton&amp;lt;BarClient&amp;gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    builder.Services.AddTransient&amp;lt;TopicResolver&amp;gt;(topicProvider =&amp;gt; key =&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// The key can be a string, Type, enum, int - whatever you need really&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;switch&lt;/span&gt; (key)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;Foo&amp;#34;&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#ff7b72&#34;&gt;return&lt;/span&gt; topicProvider.GetService&amp;lt;FooClient&amp;gt;().TopicClient;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;Bar&amp;#34;&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#ff7b72&#34;&gt;return&lt;/span&gt; topicProvider.GetService&amp;lt;BarClient&amp;gt;().TopicClient;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;default&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#ff7b72&#34;&gt;throw&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; KeyNotFoundException();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    });
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Let&amp;rsquo;s me explain what&amp;rsquo;s happening here. First we&amp;rsquo;re registering our named clients as &lt;a href=&#34;https://docs.microsoft.com/en-us/azure/service-bus-messaging/service-bus-performance-improvements#reusing-factories-and-clients&#34;&gt;&lt;strong&gt;singletons&lt;/strong&gt;&lt;/a&gt; per the explanations and reasoning given in the documentation.&lt;/p&gt;
&lt;p&gt;Next we register our &lt;code&gt;delegate&lt;/code&gt; as a transient service that will return one of the topic clients we already registered based on a &lt;code&gt;key&lt;/code&gt;. For my usage I use a &lt;code&gt;string&lt;/code&gt; key stored inside the &lt;a href=&#34;https://docs.microsoft.com/en-us/dotnet/api/microsoft.azure.servicebus.message.userproperties?view=azure-dotnet#Microsoft_Azure_ServiceBus_Message_UserProperties&#34;&gt;message user properties&lt;/a&gt;. Your &lt;code&gt;key&lt;/code&gt; can be anything like &lt;code&gt;int&lt;/code&gt;, &lt;code&gt;enum&lt;/code&gt; or a specific &lt;code&gt;Type&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Last thing we have to do is to put our &lt;code&gt;TopicResolver&lt;/code&gt; to work!&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// Code below uses a MediatR handler as an example&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#f0883e;font-weight:bold&#34;&gt;MessageHandler&lt;/span&gt; : IRequestHandler&amp;lt;Message, &lt;span style=&#34;color:#ff7b72&#34;&gt;bool&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;readonly&lt;/span&gt; TopicResolver topicResolver;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; MessageHandler(TopicResolver topicResolver)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;this&lt;/span&gt;.topicResolver = topicResolver ?? &lt;span style=&#34;color:#ff7b72&#34;&gt;throw&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; ArgumentNullException(nameof(topicResolver));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;async&lt;/span&gt; Task&amp;lt;&lt;span style=&#34;color:#ff7b72&#34;&gt;bool&lt;/span&gt;&amp;gt; Handle(Message msg, CancellationToken cancellationToken)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;if&lt;/span&gt; (msg == &lt;span style=&#34;color:#ff7b72&#34;&gt;null&lt;/span&gt;) &lt;span style=&#34;color:#ff7b72&#34;&gt;throw&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; ArgumentNullException(nameof(msg));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;try&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;             &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// Use a field from the user properties of the message as key&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;             &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// The client we get can be either FooClient or BarClient based on the value&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; client = topicResolver(msg.UserProperties[&lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;Key&amp;#34;&lt;/span&gt;]);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;await&lt;/span&gt; client.SendAsync(msg);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;true&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;catch&lt;/span&gt; (Exception ex)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;false&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;As a bonus here&amp;rsquo;s how to test if the &lt;code&gt;delegate&lt;/code&gt; is doing it&amp;rsquo;s job and verifying that the right client is called.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;System&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;System.Threading.Tasks&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;AutoFixture&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;MediatR&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;Microsoft.Azure.ServiceBus&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;Moq&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;Shouldly&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;Xunit&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;namespace&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;FooBarApp.Tests&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#f0883e;font-weight:bold&#34;&gt;MessageHandlerTests&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;readonly&lt;/span&gt; Mock&amp;lt;TopicResolver&amp;gt; topicResolver;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;readonly&lt;/span&gt; Fixture fixture;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;private&lt;/span&gt; IRequestHandler&amp;lt;Message, &lt;span style=&#34;color:#ff7b72&#34;&gt;bool&lt;/span&gt;&amp;gt; sut;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; MessageHandlerTests()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            topicResolver = &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; Mock&amp;lt;TopicResolver&amp;gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            fixture = &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; Fixture();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        [Fact]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;async&lt;/span&gt; Task Handle_ValidMessageRequest_Foo_SendsMessage()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; message = fixture.Create&amp;lt;Message&amp;gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// Best will be to create a customizer for different Messages&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            message.UserProperties.Add(&lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;Key&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;Foo&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; client = &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; Mock&amp;lt;ITopicClient&amp;gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            topicResolver.Setup(x =&amp;gt; x.Invoke(It.IsAny&amp;lt;&lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt;&amp;gt;()))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                .Returns(client.Object);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            sut = &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; MessageHandler(topicResolver.Object);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;await&lt;/span&gt; sut.Handle(message, &lt;span style=&#34;color:#ff7b72&#34;&gt;default&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            topicResolver.Verify(x =&amp;gt; x(&lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;Foo&amp;#34;&lt;/span&gt;), Times.Once);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            client.Verify((x =&amp;gt; x.SendAsync(It.IsAny&amp;lt;Message&amp;gt;())), Times.Once);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        [Fact]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;async&lt;/span&gt; Task Handle_ValidMessageRequest_Bar_SendsMessage()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; message = fixture.Create&amp;lt;Message&amp;gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// Best will be to create a customizer for different Messages&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            message.UserProperties.Add(&lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;Key&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;Bar&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; client = &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; Mock&amp;lt;ITopicClient&amp;gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            topicResolver.Setup(x =&amp;gt; x.Invoke(It.IsAny&amp;lt;&lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt;&amp;gt;()))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                .Returns(client.Object);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            sut = &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; MessageHandler(topicResolver.Object);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;await&lt;/span&gt; sut.Handle(message, &lt;span style=&#34;color:#ff7b72&#34;&gt;default&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            topicResolver.Verify(x =&amp;gt; x(&lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;Bar&amp;#34;&lt;/span&gt;), Times.Once);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            client.Verify((x =&amp;gt; x.SendAsync(It.IsAny&amp;lt;Message&amp;gt;())), Times.Once);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And that&amp;rsquo;s it! With this setup now you can add multiple topic clients with ease! Hope you find this post useful. There are other ways to accomplish the same thing and solve this problem, but I like this approach because it&amp;rsquo;s extremely clean, elegant and testable!&lt;/p&gt;
- https://underscorehao.net/2020/01/publishing-to-multiple-topics-in-azure-service-bus/ - Copyright 2017-2023 by Pavel Danov</description>
        </item>
    
    
    
        <item>
        <title>Auto Refreshing Cache in .NET</title>
        <link>https://underscorehao.net/2019/07/auto-refreshing-cache-in-dotnet/</link>
        <pubDate>Thu, 11 Jul 2019 22:47:02 +0100</pubDate>
        
        <guid>https://underscorehao.net/2019/07/auto-refreshing-cache-in-dotnet/</guid>
        <description>Pavel Danov https://underscorehao.net/2019/07/auto-refreshing-cache-in-dotnet/ -&lt;h2 id=&#34;caching-is-hard&#34;&gt;Caching is hard&lt;/h2&gt;
&lt;p&gt;On a bright sunny day while you&amp;rsquo;re working on your awesome project you catch a glimpse of something. You bring yourself closer to the monitor and begin meticulously examining your code. What you find brings you feelings of disgust and shame! You&amp;rsquo;ve been calling an API retrieving data you need over and over again even though said data hardly changes!&lt;/p&gt;
&lt;p&gt;Being the smart and responsible engineer that you are, you decide to rectify your mistake immediately. You think to yourself&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&amp;ldquo;OK, I&amp;rsquo;ll just implement caching around that piece of data and I&amp;rsquo;m done!&amp;rdquo;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Not so fast! Little do you know that you&amp;rsquo;re opening the gates of your own small personal hell!&lt;/p&gt;
&lt;h2 id=&#34;caching-in-net&#34;&gt;Caching in .NET&lt;/h2&gt;
&lt;p&gt;The little story above is a &lt;em&gt;slight&lt;/em&gt; exaggeration, but caching is indeed a touchy subject. It&amp;rsquo;s a nice performance boost when done right, but it can also lead you to a dark path filled with scary monsters and unforeseen problems.&lt;/p&gt;
&lt;p&gt;There are many articles written on caching in .NET, you should read the official docs and perhaps other articles written by the good people on the Internet.&lt;/p&gt;
&lt;p&gt;This article however will deal with a very specific caching problem. How can you implement a cache that is refreshing itself after a specific amount of time with the following characteristics:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Thread safety&lt;/li&gt;
&lt;li&gt;Not getting any cache misses (even if that means we&amp;rsquo;re returning stale data)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;If that&amp;rsquo;s what you need, keep on reading!&lt;/p&gt;
&lt;h2 id=&#34;implementation-with-memorycache-in-net-framework&#34;&gt;Implementation with MemoryCache in .NET Framework&lt;/h2&gt;
&lt;p&gt;Let&amp;rsquo;s start with the simple stuff. We want to perform some basic CRUD operations on our cache - saving data to it, getting our cached objects and potentially deleting our data. The best way to do it is to define an interface.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;System.Runtime.Caching&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;namespace&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;FooBar.Caching&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;interface&lt;/span&gt; &lt;span style=&#34;color:#f0883e;font-weight:bold&#34;&gt;IMemoryAutoRefreshCache&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        T GetById&amp;lt;T&amp;gt;(&lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt; id);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;void&lt;/span&gt; Save&amp;lt;T&amp;gt;(&lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt; id, T cacheObj, CacheItemPolicy refreshPolicy);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;void&lt;/span&gt; Remove(&lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt; id);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;These are the methods I&amp;rsquo;m going to use to illustrate my example. Depending on your use case you can have a lot more of them doing various things to your cache, but for my case those are enough. The point I want you to focus on here is the &lt;strong&gt;&lt;code&gt;CacheItemPolicy&lt;/code&gt;&lt;/strong&gt; we can set during the Save.&lt;/p&gt;
&lt;p&gt;Now that we have our interface we can also implement it in a new class&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;System.Runtime.Caching&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;namespace&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;FooBar.Caching&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#f0883e;font-weight:bold&#34;&gt;MemoryAutoRefreshCache&lt;/span&gt; : IMemoryAutoRefreshCache
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;readonly&lt;/span&gt; MemoryCache memoryCache;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; MemoryAutoRefreshCache(MemoryCache memoryCache = &lt;span style=&#34;color:#ff7b72&#34;&gt;null&lt;/span&gt;) =&amp;gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;this&lt;/span&gt;.memoryCache = memoryCache ?? MemoryCache.Default;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; T GetById&amp;lt;T&amp;gt;(&lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt; id)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;value&lt;/span&gt; = (T)memoryCache.Get(id);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#ff7b72&#34;&gt;value&lt;/span&gt; == &lt;span style=&#34;color:#ff7b72&#34;&gt;null&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#ff7b72&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;default&lt;/span&gt;(T);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;value&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;void&lt;/span&gt; Save&amp;lt;T&amp;gt;(&lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt; id, T result, CacheItemPolicy refreshPolicy)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            memoryCache.Set(id, result, refreshPolicy);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;void&lt;/span&gt; Remove(&lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt; id)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            memoryCache.Remove(id);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Nothing out of the ordinary here. I want to bring your attention to our &lt;strong&gt;&lt;code&gt;Save&lt;/code&gt;&lt;/strong&gt; method one more time and the CacheItemPolicy. The summary of &lt;strong&gt;&lt;code&gt;CacheItemPolicy&lt;/code&gt;&lt;/strong&gt; states:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Represents a set of eviction and expiration details for a specific cache entry.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Inside the &lt;strong&gt;&lt;code&gt;CacheItemPolicy&lt;/code&gt;&lt;/strong&gt; we have two callbacks which will give us everything we need to accomplish our task.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.microsoft.com/en-us/dotnet/api/system.runtime.caching.cacheentryremovedcallback?view=netframework-4.8&#34;&gt;&lt;strong&gt;&lt;code&gt;RemovedCallback&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt; - Occurs &lt;strong&gt;&lt;em&gt;after&lt;/em&gt;&lt;/strong&gt; the item has been removed&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.microsoft.com/en-us/dotnet/api/system.runtime.caching.cacheentryupdatecallback?view=netframework-4.8&#34;&gt;&lt;strong&gt;&lt;code&gt;UpdateCallback&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt; - Occurs &lt;strong&gt;&lt;em&gt;before&lt;/em&gt;&lt;/strong&gt; the item is removed&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;As you can imagine we&amp;rsquo;ll use the &lt;strong&gt;&lt;code&gt;UpdateCallback&lt;/code&gt;&lt;/strong&gt; in our case.&lt;/p&gt;
&lt;p&gt;So let&amp;rsquo;s see how an implementation of this auto refreshing cache will look like!&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;System&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;System.Runtime.Caching&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;System.Threading&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;FooBar.Caching&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;namespace&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;FooBar.Services.Configuration&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#f0883e;font-weight:bold&#34;&gt;ConfigurationProvider&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;readonly&lt;/span&gt; IMemoryAutoRefreshCache localCache;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt; cacheKey = &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;myAwesomeCacheKey&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;readonly&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;object&lt;/span&gt; _lock = &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;object&lt;/span&gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; ConfigurationProvider(ILocalAutoRefreshCache localCache) =&amp;gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;this&lt;/span&gt;.localCache = localCache;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; Configuration GetConfiguration()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; cachedConfig = localCache.GetById&amp;lt;Configuration&amp;gt;(cacheKey);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;if&lt;/span&gt; (cachedConfig != &lt;span style=&#34;color:#ff7b72&#34;&gt;null&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#ff7b72&#34;&gt;return&lt;/span&gt; cachedConfig;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;lock&lt;/span&gt; (_lock)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// Check to see if anyone wrote in the cache while we&amp;#39;re waiting for our turn&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                cachedConfig = localCache.GetById&amp;lt;Configuration&amp;gt;(cacheKey);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#ff7b72&#34;&gt;if&lt;/span&gt; (cachedConfig != &lt;span style=&#34;color:#ff7b72&#34;&gt;null&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    &lt;span style=&#34;color:#ff7b72&#34;&gt;return&lt;/span&gt; cachedConfig;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// This method is not implemented because it can be anything. The main part is that you want to cache an object.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                cachedConfig = GetConfigurationFromRemoteLocation(provider);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#ff7b72&#34;&gt;int&lt;/span&gt; refreshTimeInSeconds = &lt;span style=&#34;color:#a5d6ff&#34;&gt;3600&lt;/span&gt;; &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// 1 hour&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                localCache.Save(cacheKey, cachedConfig, GetPolicy(refreshTimeInSeconds));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#ff7b72&#34;&gt;return&lt;/span&gt; cachedConfig;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;private&lt;/span&gt; CacheItemPolicy GetPolicy(&lt;span style=&#34;color:#ff7b72&#34;&gt;int&lt;/span&gt; refreshInterval)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; CacheItemPolicy
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// This is where the magic happens&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// The UpdateCallback will be called before our object is removed from the cache&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                UpdateCallback = (CacheEntryUpdateArguments args) =&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    &lt;span style=&#34;color:#ff7b72&#34;&gt;if&lt;/span&gt; (args.RemovedReason == CacheEntryRemovedReason.Expired)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; cacheKey = args.Key;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// Get current cached value&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; currentCachedEntity = args.Source[cacheKey] &lt;span style=&#34;color:#ff7b72&#34;&gt;as&lt;/span&gt; Configuration;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// Get the potentially new data&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; newEntity = GetConfigurationFromRemoteLocation(provider);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// If new is not null - update, otherwise just refresh the old value&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// The condition by which you decide to update or refresh the data depends entirely on you&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#ff7b72&#34;&gt;if&lt;/span&gt; (newEntity != &lt;span style=&#34;color:#ff7b72&#34;&gt;null&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                            &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; updatedEntity = newEntity;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                            args.UpdatedCacheItem = &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; CacheItem(cacheKey, updatedEntity);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                            args.UpdatedCacheItemPolicy = GetPolicy(refreshInterval);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#ff7b72&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                            &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; updatedEntity = currentCachedEntity;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                            args.UpdatedCacheItem = &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; CacheItem(cacheKey, updatedEntity);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                            args.UpdatedCacheItemPolicy = GetPolicy(refreshInterval);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                },
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                AbsoluteExpiration = DateTime.UtcNow.AddSeconds(refreshInterval),
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            };
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;So there you go! Now you can refresh, update or invalidate your cache every hour depending on the behavior you desire!&lt;/p&gt;
&lt;h3 id=&#34;bonus&#34;&gt;Bonus&lt;/h3&gt;
&lt;p&gt;As a bonus you can read on the interesting thing that happens when you put &lt;strong&gt;&lt;code&gt;AbsoluteExpiration&lt;/code&gt;&lt;/strong&gt; below 20 seconds &lt;a href=&#34;https://stackoverflow.com/questions/12630168/memorycache-absoluteexpiration-acting-strange&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Also it&amp;rsquo;s important to note that items can expire some time after the AbsoluteExpiration, there&amp;rsquo;s no guarantee that they&amp;rsquo;ll expire right on the spot. Here are two tests confirming that (I know we shouldn&amp;rsquo;t test code that isn&amp;rsquo;t ours, but it&amp;rsquo;s fun!)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;FooBar.Caching&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;NUnit.Framework&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;System&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;System.Runtime.Caching&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;System.Threading&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;System.Threading.Tasks&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;namespace&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;FooBar.Caching.UnitTests&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    [TestFixture]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#f0883e;font-weight:bold&#34;&gt;MemoryAutoRefreshCacheTests&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;private&lt;/span&gt; MemoryAutoRefreshCache subject;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;int&lt;/span&gt; updateItemCounter = &lt;span style=&#34;color:#a5d6ff&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        [SetUp]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;void&lt;/span&gt; Setup() =&amp;gt; subject = &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; MemoryAutoRefreshCache();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        [Test]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;async&lt;/span&gt; Task VerifyUpdateCallback_LocalMemoryCache()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            updateItemCounter = &lt;span style=&#34;color:#a5d6ff&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            subject.Save(&lt;span style=&#34;color:#a5d6ff&#34;&gt;$&amp;#34;key&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;value&amp;#34;&lt;/span&gt;, GetPolicy(&lt;span style=&#34;color:#a5d6ff&#34;&gt;1&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// The item can be expired between 0 and 30 seconds after expiration time&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;await&lt;/span&gt; Task.Delay(TimeSpan.FromSeconds(&lt;span style=&#34;color:#a5d6ff&#34;&gt;32&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// Test that the update callback was invoked at least once&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            Assert.IsTrue(updateItemCounter &amp;gt;= &lt;span style=&#34;color:#a5d6ff&#34;&gt;1&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        [Test]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;void&lt;/span&gt; VerifyUpdateCallbackReturnsDuringRefresh_LocalMemoryCache()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            updateItemCounter = &lt;span style=&#34;color:#a5d6ff&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt; key = &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;key&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;value&lt;/span&gt; = &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;value&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            subject.Save(key, &lt;span style=&#34;color:#ff7b72&#34;&gt;value&lt;/span&gt;, GetPolicyWithDelay(&lt;span style=&#34;color:#a5d6ff&#34;&gt;1&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// The item can be expired between 0 and 30 seconds after expiration time&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; start = DateTime.UtcNow;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;do&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; cachedItem = subject.GetById&amp;lt;&lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt;&amp;gt;(&lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;key&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                Assert.AreEqual(&lt;span style=&#34;color:#ff7b72&#34;&gt;value&lt;/span&gt;, cachedItem);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            } &lt;span style=&#34;color:#ff7b72&#34;&gt;while&lt;/span&gt; (start.AddSeconds(&lt;span style=&#34;color:#a5d6ff&#34;&gt;40&lt;/span&gt;) &amp;gt; DateTime.UtcNow);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            Assert.IsTrue(updateItemCounter &amp;gt;= &lt;span style=&#34;color:#a5d6ff&#34;&gt;1&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt; AddKeys(&lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt; key)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            updateItemCounter++;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;return&lt;/span&gt; key + key;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;void&lt;/span&gt; UpdateCounter()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            updateItemCounter++;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;private&lt;/span&gt; CacheItemPolicy GetPolicyWithDelay(&lt;span style=&#34;color:#ff7b72&#34;&gt;double&lt;/span&gt; refreshInterval)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; CacheItemPolicy
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                UpdateCallback = (CacheEntryUpdateArguments args) =&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    &lt;span style=&#34;color:#ff7b72&#34;&gt;if&lt;/span&gt; (args.RemovedReason == CacheEntryRemovedReason.Expired)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        Thread.Sleep(&lt;span style=&#34;color:#a5d6ff&#34;&gt;2000&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; id = args.Key;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// Get current cached value&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; currentCachedEntity = args.Source[id] &lt;span style=&#34;color:#ff7b72&#34;&gt;as&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        UpdateCounter();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; newEntity = args.Source[id];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// If new is not null - update, otherwise just refresh the old value&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#ff7b72&#34;&gt;if&lt;/span&gt; (newEntity != &lt;span style=&#34;color:#ff7b72&#34;&gt;null&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                            &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; updatedEntity = newEntity;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                            args.UpdatedCacheItem = &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; CacheItem(id, updatedEntity);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                            args.UpdatedCacheItemPolicy = GetPolicy(refreshInterval);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#ff7b72&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                            &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; updatedEntity = currentCachedEntity;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                            args.UpdatedCacheItem = &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; CacheItem(id, updatedEntity);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                            args.UpdatedCacheItemPolicy = GetPolicy(refreshInterval);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                },
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                AbsoluteExpiration = DateTimeOffset.UtcNow.AddSeconds(refreshInterval)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            };
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;private&lt;/span&gt; CacheItemPolicy GetPolicy(&lt;span style=&#34;color:#ff7b72&#34;&gt;double&lt;/span&gt; refreshInterval)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; CacheItemPolicy
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                UpdateCallback = (CacheEntryUpdateArguments args) =&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    &lt;span style=&#34;color:#ff7b72&#34;&gt;if&lt;/span&gt; (args.RemovedReason == CacheEntryRemovedReason.Expired)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; id = args.Key;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// Get current cached value&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; currentCachedEntity = args.Source[id] &lt;span style=&#34;color:#ff7b72&#34;&gt;as&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; newEntity = AddKeys(id);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// If new is not null - update, otherwise just refresh the old value&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#ff7b72&#34;&gt;if&lt;/span&gt; (newEntity != &lt;span style=&#34;color:#ff7b72&#34;&gt;null&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                            &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; updatedEntity = newEntity;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                            args.UpdatedCacheItem = &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; CacheItem(id, updatedEntity);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                            args.UpdatedCacheItemPolicy = GetPolicy(refreshInterval);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#ff7b72&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                            &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; updatedEntity = currentCachedEntity;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                            args.UpdatedCacheItem = &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; CacheItem(id, updatedEntity);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                            args.UpdatedCacheItemPolicy = GetPolicy(refreshInterval);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                },
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                SlidingExpiration = TimeSpan.FromSeconds(refreshInterval),
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            };
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;implementation-with-imemorycache-in-net-core&#34;&gt;Implementation with IMemoryCache in .NET Core&lt;/h2&gt;
&lt;p&gt;I have a strong feeling a lot of people will come to read this article for the part that follows&amp;hellip; Who cares about .NET Framework, amirite?! It&amp;rsquo;s all about .NET Core nowadays, son!&lt;/p&gt;
&lt;p&gt;I&amp;rsquo;d be lying if I didn&amp;rsquo;t say that I prefer the .NET Core implementation. But I digress. Let&amp;rsquo;s stay on the issue at hand - implementing an auto refreshing cache.&lt;/p&gt;
&lt;p&gt;We still have access to &lt;strong&gt;&lt;code&gt;MemoryCache&lt;/code&gt;&lt;/strong&gt; in .NET Core. However it only provides a callback which will execute &lt;strong&gt;&lt;em&gt;after&lt;/em&gt;&lt;/strong&gt; an item has been &lt;a href=&#34;https://docs.microsoft.com/en-us/dotnet/api/microsoft.extensions.caching.memory.memorycacheentryoptions.postevictioncallbacks?view=aspnetcore-2.2#Microsoft_Extensions_Caching_Memory_MemoryCacheEntryOptions_PostEvictionCallbacks&#34;&gt;removed&lt;/a&gt;. That doesn&amp;rsquo;t matter for our use case. Remember what we said at the start. We don&amp;rsquo;t care if we get stale data as long as there are no cache misses! To achieve the same thing we did in the previous section we are going to use a shiny new interface called &lt;a href=&#34;https://docs.microsoft.com/en-us/dotnet/api/microsoft.extensions.caching.memory.imemorycache?view=aspnetcore-2.2&#34;&gt;&lt;strong&gt;&lt;code&gt;IMemoryCache&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt;. And guess what! It&amp;rsquo;s provided by Microsoft too!&lt;/p&gt;
&lt;p&gt;The code is more or less the same with some differences when it comes to the locking. This time we&amp;rsquo;re performing operations inside an async method so we can&amp;rsquo;t use a regular lock. For the sake of completeness I&amp;rsquo;ll provide the full implementation + tests and gotchas after.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;System&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;System.Collections.Concurrent&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;System.Threading&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;System.Threading.Tasks&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;Microsoft.Extensions.Caching.Memory&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;namespace&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;FooBar.Providers&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#f0883e;font-weight:bold&#34;&gt;SettingsStore&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt; cacheKey = &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;FooBarPrivateKey&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;int&lt;/span&gt; refreshTimeInSeconds = &lt;span style=&#34;color:#a5d6ff&#34;&gt;3600&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;readonly&lt;/span&gt; IMemoryCache memoryCache;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;readonly&lt;/span&gt; ConcurrentDictionary&amp;lt;&lt;span style=&#34;color:#ff7b72&#34;&gt;object&lt;/span&gt;, SemaphoreSlim&amp;gt; locks = &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; ConcurrentDictionary&amp;lt;&lt;span style=&#34;color:#ff7b72&#34;&gt;object&lt;/span&gt;, SemaphoreSlim&amp;gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; SettingsStore(IMemoryCache memoryCache) =&amp;gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;this&lt;/span&gt;.memoryCache = memoryCache;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;async&lt;/span&gt; Task&amp;lt;Settings&amp;gt; GetSettingsAsync()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// Normal lock doesn&amp;#39;t work in async code&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;if&lt;/span&gt; (!memoryCache.TryGetValue(cacheKey, &lt;span style=&#34;color:#ff7b72&#34;&gt;out&lt;/span&gt; Settings settings))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                SemaphoreSlim certLock = locks.GetOrAdd(cacheKey, k =&amp;gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; SemaphoreSlim(&lt;span style=&#34;color:#a5d6ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#a5d6ff&#34;&gt;1&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#ff7b72&#34;&gt;await&lt;/span&gt; certLock.WaitAsync();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#ff7b72&#34;&gt;try&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    &lt;span style=&#34;color:#ff7b72&#34;&gt;if&lt;/span&gt; (!memoryCache.TryGetValue(cacheKey, &lt;span style=&#34;color:#ff7b72&#34;&gt;out&lt;/span&gt; settings))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// This method is not implemented because it can be anything.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// The main part is that you want to cache an object.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        settings = &lt;span style=&#34;color:#ff7b72&#34;&gt;await&lt;/span&gt; GetSettingsFromRemoteLocation();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        memoryCache.Set(cacheKey, settings, GetMemoryCacheEntryOptions(refreshTimeInSeconds)); &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// 1 hour&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#ff7b72&#34;&gt;finally&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    certLock.Release();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;return&lt;/span&gt; settings;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;private&lt;/span&gt; MemoryCacheEntryOptions GetMemoryCacheEntryOptions(&lt;span style=&#34;color:#ff7b72&#34;&gt;int&lt;/span&gt; expireInSeconds = &lt;span style=&#34;color:#a5d6ff&#34;&gt;3600&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; expirationTime = DateTime.Now.AddSeconds(expireInSeconds);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; expirationToken = &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; CancellationChangeToken(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; CancellationTokenSource(TimeSpan.FromSeconds(expireInSeconds + .&lt;span style=&#34;color:#a5d6ff&#34;&gt;01&lt;/span&gt;)).Token);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; options = &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; MemoryCacheEntryOptions();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            options.SetAbsoluteExpiration(expirationTime);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            options.AddExpirationToken(expirationToken);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            options.PostEvictionCallbacks.Add(&lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; PostEvictionCallbackRegistration()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                EvictionCallback = (key, &lt;span style=&#34;color:#ff7b72&#34;&gt;value&lt;/span&gt;, reason, state) =&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    &lt;span style=&#34;color:#ff7b72&#34;&gt;if&lt;/span&gt; (reason == EvictionReason.TokenExpired || reason == EvictionReason.Expired)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// If newValue is not null - update, otherwise just refresh the old value&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// The condition by which you decide to update or refresh the data depends entirely on you&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// If you want a cache object that will never expire you can just make the following call:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// memoryCache.Set(key, value, GetMemoryCacheEntryOptions(expireInSeconds));&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; newValue = &lt;span style=&#34;color:#ff7b72&#34;&gt;await&lt;/span&gt; GetSettingsFromRemoteLocation();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#ff7b72&#34;&gt;if&lt;/span&gt; (newValue != &lt;span style=&#34;color:#ff7b72&#34;&gt;null&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                            memoryCache.Set(key, newValue, GetMemoryCacheEntryOptions(expireInSeconds)); &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// 1 hour&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#ff7b72&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                            memoryCache.Set(key, &lt;span style=&#34;color:#ff7b72&#34;&gt;value&lt;/span&gt;, GetMemoryCacheEntryOptions(expireInSeconds)); &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// 1 hour&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            });
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;return&lt;/span&gt; options;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Here we have 2 interesting behaviors we should take into consideration. Why do we need to use a cancellation token, and why won&amp;rsquo;t the &lt;strong&gt;&lt;code&gt;EvictionCallback&lt;/code&gt;&lt;/strong&gt; execute after 1 hour without explicitly setting said token.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/aspnet/Caching/issues/248&#34;&gt;No background thread that actively scans the expiration&lt;/a&gt;. This means we have to trigger the eviction/expiration ourselves.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://stackoverflow.com/a/47949111/2265179&#34;&gt;We can trigger an expiration with the help of a CancellationToken&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To prove this to you I&amp;rsquo;ll provide another pair of tests&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;System&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;System.Threading&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;System.Threading.Tasks&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;Microsoft.Extensions.Caching.Memory&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;Microsoft.Extensions.Primitives&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;Microsoft.VisualStudio.TestTools.UnitTesting&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;namespace&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;FooBar.Tests&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    [TestClass]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#f0883e;font-weight:bold&#34;&gt;MemoryCacheTests&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;private&lt;/span&gt; IMemoryCache CreateCache()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; MemoryCache(&lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; MemoryCacheOptions()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                ExpirationScanFrequency = &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; TimeSpan(&lt;span style=&#34;color:#a5d6ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#a5d6ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#a5d6ff&#34;&gt;1&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            });
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        [TestMethod]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;async&lt;/span&gt; Task ExpireAndReAddFromCallbackWorks()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; cache = CreateCache();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; initialValue = &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;I&amp;#39;m a value&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; newValue = &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;I&amp;#39;m the refreshed value&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt; key = &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;myKey&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;int&lt;/span&gt; refreshCounter = &lt;span style=&#34;color:#a5d6ff&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; options = &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; MemoryCacheEntryOptions();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            options.SetAbsoluteExpiration(&lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; TimeSpan(&lt;span style=&#34;color:#a5d6ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#a5d6ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#a5d6ff&#34;&gt;1&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            options.PostEvictionCallbacks.Add(&lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; PostEvictionCallbackRegistration()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                EvictionCallback = (subkey, subValue, reason, state) =&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    &lt;span style=&#34;color:#ff7b72&#34;&gt;if&lt;/span&gt; (reason == EvictionReason.Expired)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        cache.Set(key, newValue);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        refreshCounter++;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            });
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            cache.Set(key, initialValue, options);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;await&lt;/span&gt; Task.Delay(TimeSpan.FromSeconds(&lt;span style=&#34;color:#a5d6ff&#34;&gt;6&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// Any activity on the cache (Get, Set, Remove) can trigger a background scan for expired items.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// There&amp;#39;s no background thread that scans the cache for expired times&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; result = cache.Get(key);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;await&lt;/span&gt; Task.Delay(TimeSpan.FromSeconds(&lt;span style=&#34;color:#a5d6ff&#34;&gt;1&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            Assert.IsTrue(refreshCounter &amp;gt;= &lt;span style=&#34;color:#a5d6ff&#34;&gt;1&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            Assert.AreEqual(newValue, cache.Get(key));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        [TestMethod]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;async&lt;/span&gt; Task TokenExpireAndReAddFromCallbackWorks()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; cache = CreateCache();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; initialValue = &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;I&amp;#39;m a value&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; newValue = &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;I&amp;#39;m the refreshed value&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt; key = &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;myKey&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;int&lt;/span&gt; refreshCounter = &lt;span style=&#34;color:#a5d6ff&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;int&lt;/span&gt; expirationSeconds = &lt;span style=&#34;color:#a5d6ff&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; expirationTime = DateTime.Now.AddSeconds(expirationSeconds);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; expirationToken = &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; CancellationChangeToken(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; CancellationTokenSource(TimeSpan.FromSeconds(expirationSeconds + .&lt;span style=&#34;color:#a5d6ff&#34;&gt;01&lt;/span&gt;)).Token);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; options = &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; MemoryCacheEntryOptions();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            options.SetAbsoluteExpiration(expirationTime);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            options.AddExpirationToken(expirationToken);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            options.PostEvictionCallbacks.Add(&lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; PostEvictionCallbackRegistration()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                EvictionCallback = (subkey, subValue, reason, state) =&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    &lt;span style=&#34;color:#ff7b72&#34;&gt;if&lt;/span&gt; (reason == EvictionReason.TokenExpired)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        cache.Set(key, newValue);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        refreshCounter++;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            });
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            cache.Set(key, initialValue, options);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;await&lt;/span&gt; Task.Delay(TimeSpan.FromSeconds(&lt;span style=&#34;color:#a5d6ff&#34;&gt;6&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            Assert.IsTrue(refreshCounter &amp;gt;= &lt;span style=&#34;color:#a5d6ff&#34;&gt;1&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            Assert.AreEqual(newValue, cache.Get(key));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;So that&amp;rsquo;s basically it! Now we have our auto refreshing cache! There&amp;rsquo;s a lot that we can improve. You have to be careful who has access to the keys for your specific object and a million other considerations. Caching is a steep hill to climb, but I hope you found this blog post informative in some capacity!&lt;/p&gt;
&lt;p&gt;I&amp;rsquo;ve used both implementations for some heavy objects that don&amp;rsquo;t change often in production environments and they&amp;rsquo;ve been doing their job pretty well so far!&lt;/p&gt;
- https://underscorehao.net/2019/07/auto-refreshing-cache-in-dotnet/ - Copyright 2017-2023 by Pavel Danov</description>
        </item>
    
    
    
        <item>
        <title>.NET Core API with DynamoDB Context Dependency Injection</title>
        <link>https://underscorehao.net/2018/03/net-core-api-dynamodb-dependency-injection/</link>
        <pubDate>Tue, 13 Mar 2018 22:27:05 +0200</pubDate>
        
        <guid>https://underscorehao.net/2018/03/net-core-api-dynamodb-dependency-injection/</guid>
        <description>Pavel Danov https://underscorehao.net/2018/03/net-core-api-dynamodb-dependency-injection/ -&lt;h2 id=&#34;the-problem&#34;&gt;The Problem&lt;/h2&gt;
&lt;p&gt;Today I faced a problem which I knew would come, but didn&amp;rsquo;t have time to implement properly at the time. There were more urgent tasks at hand before, deadlines to be met and this issue remained unresolved.&lt;/p&gt;
&lt;p&gt;Amazon&amp;rsquo;s .NET Core SDK is very good for the most part. Everything works as it should. But let&amp;rsquo;s say you use the &lt;a href=&#34;https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DotNetSDKHighLevel.html&#34;&gt;.NET Object Persistence Model&lt;/a&gt; for &lt;a href=&#34;https://aws.amazon.com/dynamodb/&#34;&gt;DynamoDB&lt;/a&gt; in your service and you have mapped C# classes to DynamoDB tables like this:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;namespace&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;Models&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    [DynamoDBTable(&amp;#34;Player&amp;#34;)]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#f0883e;font-weight:bold&#34;&gt;Player&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        [DynamoDBHashKey]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;int&lt;/span&gt; Id { &lt;span style=&#34;color:#ff7b72&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#ff7b72&#34;&gt;set&lt;/span&gt;; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        [DynamoDBProperty]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt; Name { &lt;span style=&#34;color:#ff7b72&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#ff7b72&#34;&gt;set&lt;/span&gt;; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        [DynamoDBProperty]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;int&lt;/span&gt; HitPoints { &lt;span style=&#34;color:#ff7b72&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#ff7b72&#34;&gt;set&lt;/span&gt;; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        [DynamoDBProperty]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;int&lt;/span&gt; Gold { &lt;span style=&#34;color:#ff7b72&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#ff7b72&#34;&gt;set&lt;/span&gt;; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        [DynamoDBProperty]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;int&lt;/span&gt; Level { &lt;span style=&#34;color:#ff7b72&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#ff7b72&#34;&gt;set&lt;/span&gt;; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        [DynamoDBProperty]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; List&amp;lt;&lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt;&amp;gt; Items { &lt;span style=&#34;color:#ff7b72&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#ff7b72&#34;&gt;set&lt;/span&gt;; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    [DynamoDBTable(&amp;#34;Location&amp;#34;)]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#f0883e;font-weight:bold&#34;&gt;Location&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        [DynamoDBHashKey]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;int&lt;/span&gt; Id { &lt;span style=&#34;color:#ff7b72&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#ff7b72&#34;&gt;set&lt;/span&gt;; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        [DynamoDBProperty]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt; Name { &lt;span style=&#34;color:#ff7b72&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#ff7b72&#34;&gt;set&lt;/span&gt;; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        [DynamoDBProperty]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt; Description { &lt;span style=&#34;color:#ff7b72&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#ff7b72&#34;&gt;set&lt;/span&gt;; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;It works well. Everything is mapped as it should. You have a service that calls the .NET SDK so you can write, read and delete data from the context like this:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;namespace&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;Services&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#f0883e;font-weight:bold&#34;&gt;DynamoDbService&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;async&lt;/span&gt; Task&amp;lt;T&amp;gt; GetAsync&amp;lt;T&amp;gt;(&lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt; id)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;try&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                DynamoDBContext context = &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; DynamoDBContext(_dynamoDbClient);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#ff7b72&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;await&lt;/span&gt; context.LoadAsync&amp;lt;T&amp;gt;(id);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;catch&lt;/span&gt; (Exception ex)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#ff7b72&#34;&gt;throw&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; Exception(&lt;span style=&#34;color:#a5d6ff&#34;&gt;$&amp;#34;Amazon error in Get operation! Error: {ex}&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;async&lt;/span&gt; Task WriteAsync&amp;lt;T&amp;gt;(T item)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;try&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                DynamoDBContext context = &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; DynamoDBContext(_dynamoDbClient);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#ff7b72&#34;&gt;await&lt;/span&gt; context.SaveAsync(item);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;catch&lt;/span&gt; (Exception ex)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#ff7b72&#34;&gt;throw&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; Exception(&lt;span style=&#34;color:#a5d6ff&#34;&gt;$&amp;#34;Amazon error in Write operation! Error: {ex}&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;async&lt;/span&gt; Task DeleteAsync&amp;lt;T&amp;gt;(T item)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;try&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                DynamoDBContext context = &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; DynamoDBContext(_dynamoDbClient);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#ff7b72&#34;&gt;await&lt;/span&gt; context.DeleteAsync(item)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;catch&lt;/span&gt; (Exception ex)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#ff7b72&#34;&gt;throw&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; Exception(&lt;span style=&#34;color:#a5d6ff&#34;&gt;$&amp;#34;Amazon error in Delete operation! Error: {ex}&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;It&amp;rsquo;s all fun and games until you have to use different databases for different environments! Of course you can use the &lt;a href=&#34;https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DotNetSDKMidLevel.html&#34;&gt;Document Model&lt;/a&gt;, but then you lose the nice mapping to C# classes and have to work with generic documents.&lt;/p&gt;
&lt;p&gt;C# attributes are not meant to change at runtime, so we&amp;rsquo;re in a tough spot! What can we do to tell our build pipeline which tables we&amp;rsquo;d like to use?&lt;/p&gt;
&lt;h2 id=&#34;the-solution&#34;&gt;The Solution&lt;/h2&gt;
&lt;p&gt;.NET Core&amp;rsquo;s powerful dependency injection comes to our rescue! First we create the same section (with the respective databases for our environments) in our &lt;strong&gt;&lt;code&gt;appsettings.Development.json&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;DynamoDbTables&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f85149&#34;&gt;:&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7ee787&#34;&gt;&amp;#34;Player&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;DevPlayer&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7ee787&#34;&gt;&amp;#34;Location&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;DevLocation&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;and &lt;strong&gt;&lt;code&gt;appsettings.json&lt;/code&gt;&lt;/strong&gt; file&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;DynamoDbTables&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f85149&#34;&gt;:&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7ee787&#34;&gt;&amp;#34;Player&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;ProdPlayer&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7ee787&#34;&gt;&amp;#34;Location&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;ProdLocation&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Then we head up and create a simple configuration class which we&amp;rsquo;ll bind to our DynamoDbTables JSON object later&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#f0883e;font-weight:bold&#34;&gt;DynamoDbOptions&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt; Player { &lt;span style=&#34;color:#ff7b72&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#ff7b72&#34;&gt;set&lt;/span&gt;; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt; Location { &lt;span style=&#34;color:#ff7b72&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#ff7b72&#34;&gt;set&lt;/span&gt;; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;After that we have to create our custom DynamoDb context interface&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;interface&lt;/span&gt; &lt;span style=&#34;color:#f0883e;font-weight:bold&#34;&gt;IDynamoDbContext&lt;/span&gt;&amp;lt;T&amp;gt; : IDisposable &lt;span style=&#34;color:#ff7b72&#34;&gt;where&lt;/span&gt; T : &lt;span style=&#34;color:#ff7b72&#34;&gt;class&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    Task&amp;lt;T&amp;gt; GetByIdAsync(&lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt; id);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    Task SaveAsync(T item);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    Task DeleteByIdAsync(T item);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;and the context class which we&amp;rsquo;ll inject in our services&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#f0883e;font-weight:bold&#34;&gt;DynamoDbContext&lt;/span&gt;&amp;lt;T&amp;gt; : DynamoDBContext, IDynamoDbContext&amp;lt;T&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;where&lt;/span&gt; T : &lt;span style=&#34;color:#ff7b72&#34;&gt;class&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;private&lt;/span&gt; DynamoDBOperationConfig _config;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; DynamoDbContext(IAmazonDynamoDB client, &lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt; tableName)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        : &lt;span style=&#34;color:#ff7b72&#34;&gt;base&lt;/span&gt;(client)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        _config = &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; DynamoDBOperationConfig()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            OverrideTableName = tableName
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        };
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;async&lt;/span&gt; Task&amp;lt;T&amp;gt; GetByIdAsync(&lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt; id)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;await&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;base&lt;/span&gt;.LoadAsync&amp;lt;T&amp;gt;(id, _config);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;async&lt;/span&gt; Task SaveAsync(T item)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;await&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;base&lt;/span&gt;.SaveAsync(item, _config);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;async&lt;/span&gt; Task DeleteByIdAsync(T item)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;await&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;base&lt;/span&gt;.DeleteAsync(item, _config);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Then we go to our &lt;strong&gt;&lt;code&gt;Startup.cs&lt;/code&gt;&lt;/strong&gt; and add a couple of lines to our &lt;strong&gt;&lt;code&gt;ConfigureServices()&lt;/code&gt;&lt;/strong&gt; method&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// AWS Options&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; awsOptions = Configuration.GetAWSOptions();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;services.AddDefaultAWSOptions(awsOptions);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; client = awsOptions.CreateServiceClient&amp;lt;IAmazonDynamoDB&amp;gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;var&lt;/span&gt; dynamoDbOptions = &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; DynamoDbOptions();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ConfigurationBinder.Bind(Configuration.GetSection(&lt;span style=&#34;color:#a5d6ff&#34;&gt;&amp;#34;DynamoDbTables&amp;#34;&lt;/span&gt;), dynamoDbOptions);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// This is where the magic happens&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;services.AddScoped&amp;lt;IDynamoDbContext&amp;lt;Player&amp;gt;&amp;gt;(provider =&amp;gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; DynamoDbContext&amp;lt;Player&amp;gt;(client, dynamoDbOptions.Player));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;services.AddScoped&amp;lt;IDynamoDbContext&amp;lt;Location&amp;gt;&amp;gt;(provider =&amp;gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; DynamoDbContext&amp;lt;Location&amp;gt;(client, dynamoDbOptions.Location));
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And voilà! We can now remove the &lt;strong&gt;&lt;code&gt;[DynamoDBTable(&amp;quot;SomeTableName&amp;quot;)]&lt;/code&gt;&lt;/strong&gt; attributes from our classes. We can keep both &lt;strong&gt;&lt;code&gt;[DynamoDBHashKey]&lt;/code&gt;&lt;/strong&gt; and &lt;strong&gt;&lt;code&gt;[DynamoDBProperty]&lt;/code&gt;&lt;/strong&gt; attributes. If we need custom converters we can just add &lt;strong&gt;&lt;code&gt;[DynamoDBProperty(typeof(SomeConverter))]&lt;/code&gt;&lt;/strong&gt; attribute to our property.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// No table name attribute needed!&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#f0883e;font-weight:bold&#34;&gt;Player&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    [DynamoDBHashKey]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;int&lt;/span&gt; Id { &lt;span style=&#34;color:#ff7b72&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#ff7b72&#34;&gt;set&lt;/span&gt;; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    [DynamoDBProperty]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt; Name { &lt;span style=&#34;color:#ff7b72&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#ff7b72&#34;&gt;set&lt;/span&gt;; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    [DynamoDBProperty]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;int&lt;/span&gt; HitPoints { &lt;span style=&#34;color:#ff7b72&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#ff7b72&#34;&gt;set&lt;/span&gt;; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    [DynamoDBProperty]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;int&lt;/span&gt; Gold { &lt;span style=&#34;color:#ff7b72&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#ff7b72&#34;&gt;set&lt;/span&gt;; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    [DynamoDBProperty]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;int&lt;/span&gt; Level { &lt;span style=&#34;color:#ff7b72&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#ff7b72&#34;&gt;set&lt;/span&gt;; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    [DynamoDBProperty]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; List&amp;lt;&lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt;&amp;gt; Items { &lt;span style=&#34;color:#ff7b72&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#ff7b72&#34;&gt;set&lt;/span&gt;; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8b949e;font-style:italic&#34;&gt;// No table name attribute needed!&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#f0883e;font-weight:bold&#34;&gt;Location&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    [DynamoDBHashKey]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;int&lt;/span&gt; Id { &lt;span style=&#34;color:#ff7b72&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#ff7b72&#34;&gt;set&lt;/span&gt;; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    [DynamoDBProperty]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt; Name { &lt;span style=&#34;color:#ff7b72&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#ff7b72&#34;&gt;set&lt;/span&gt;; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    [DynamoDBProperty]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt; Description { &lt;span style=&#34;color:#ff7b72&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#ff7b72&#34;&gt;set&lt;/span&gt;; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;and we can use the desired context with their respective tables in our services!&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff7b72&#34;&gt;namespace&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;Services&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#f0883e;font-weight:bold&#34;&gt;AwesomeDynamoDbService&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;private&lt;/span&gt; IDynamoDbContext&amp;lt;Player&amp;gt; _playerContext;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;private&lt;/span&gt; IDynamoDbContext&amp;lt;Location&amp;gt; _locationContext;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; AwesomeDynamoDbService(IDynamoDbContext&amp;lt;Player&amp;gt; playerContext, IDynamoDbContext&amp;lt;Location&amp;gt; locationContext)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            _playerContext = playerContext;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            _locationContext = locationContext;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;async&lt;/span&gt; Task&amp;lt;User&amp;gt; GetUserAsync(&lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt; id)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;try&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#ff7b72&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;await&lt;/span&gt; _playerContext.GetByIdAsync(id);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;catch&lt;/span&gt; (Exception ex)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#ff7b72&#34;&gt;throw&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; Exception(&lt;span style=&#34;color:#a5d6ff&#34;&gt;$&amp;#34;Amazon error in GetUser table operation! Error: {ex}&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff7b72&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;async&lt;/span&gt; Task&amp;lt;Location&amp;gt; GetLocationAsync(&lt;span style=&#34;color:#ff7b72&#34;&gt;string&lt;/span&gt; id)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;try&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#ff7b72&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;await&lt;/span&gt; _locationContext.GetByIdAsync(id);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff7b72&#34;&gt;catch&lt;/span&gt; (Exception ex)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#ff7b72&#34;&gt;throw&lt;/span&gt; &lt;span style=&#34;color:#ff7b72&#34;&gt;new&lt;/span&gt; Exception(&lt;span style=&#34;color:#a5d6ff&#34;&gt;$&amp;#34;Amazon error in GetLocation table operation! Error: {ex}&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Depending on your case you can use different services for different tables or other requirements. This solution might seem a bit more cumbersome than the original, but it makes us flexible in case we need to work with multiple databases and different build environments. The only thing you have to do is to tell your build tool/pipeline to change the table names in your &lt;strong&gt;&lt;code&gt;appsettings.json&lt;/code&gt;&lt;/strong&gt; files.&lt;/p&gt;
&lt;p&gt;This method also is more robust when it comes to testing because it&amp;rsquo;ll be much easier to mock! All in all I&amp;rsquo;m really happy with how it all turned out!&lt;/p&gt;
- https://underscorehao.net/2018/03/net-core-api-dynamodb-dependency-injection/ - Copyright 2017-2023 by Pavel Danov</description>
        </item>
    
    
  </channel>
</rss> 